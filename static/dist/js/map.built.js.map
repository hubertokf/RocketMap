{"version":3,"sources":["../../js/map.js"],"names":["$selectExclude","$selectPokemonNotify","$selectRarityNotify","$textPerfectionNotify","$selectStyle","$selectIconSize","$switchOpenGymsOnly","$switchActiveRaidGymsOnly","$switchRaidMinLevel","$switchRaidMaxLevel","$selectTeamGymsOnly","$selectLastUpdateGymsOnly","$selectMinGymLevel","$selectMaxGymLevel","$selectLuredPokestopsOnly","$selectSearchIconMarker","$selectLocationIconMarker","$switchGymSidebar","language","document","documentElement","lang","idToPokemon","i8lnDictionary","languageLookups","languageLookupThreshold","searchMarkerStyles","timestamp","excludedPokemon","notifiedPokemon","notifiedRarity","notifiedMinPerfection","buffer","reincludedPokemon","reids","map","markerCluster","rawDataIsLoading","locationMarker","rangeMarkers","searchMarker","storeZoom","moves","oSwLat","oSwLng","oNeLat","oNeLng","lastpokestops","lastgyms","lastpokemon","lastslocs","lastspawns","selectedStyle","updateWorker","lastUpdateTime","redrawTimeout","gymTypes","audio","Audio","cryFileTypes","genderType","unownForm","notifyIvTitle","notifyNoIvTitle","notifyText","excludePokemon","id","val","concat","trigger","notifyAboutPokemon","removePokemonMarker","encounterId","mapData","pokemons","marker","rangeCircle","setMap","hidden","initMap","google","maps","Map","getElementById","center","lat","Number","getParameterByName","centerLat","lng","centerLng","zoom","Store","get","fullscreenControl","streetViewControl","mapTypeControl","clickableIcons","mapTypeControlOptions","style","MapTypeControlStyle","DROPDOWN_MENU","position","ControlPosition","RIGHT_TOP","mapTypeIds","MapTypeId","ROADMAP","SATELLITE","HYBRID","clusterOptions","imagePath","maxZoom","zoomOnClick","gridSize","MarkerClusterer","styleNoLabels","StyledMapType","noLabelsStyle","name","mapTypes","set","styleDark","darkStyle","styleLight2","light2Style","stylePgo","pGoStyle","styleDarkNl","darkStyleNoLabels","styleLight2Nl","light2StyleNoLabels","stylePgoNl","pGoStyleNoLabels","stylePgoDay","pGoStyleDay","stylePgoNight","pGoStyleNight","currentDate","Date","currentHour","getHours","stylePgoDynamic","addListener","s","mapTypeId","setMapTypeId","updateMap","getZoom","clearTimeout","setTimeout","redrawPokemon","lurePokemons","resetViewport","redraw","createSearchMarker","createLocationMarker","createMyLocationButton","initSidebar","$","on","loc","getCenter","changeLocation","checked","prop","searchControl","updateLocationMarker","url","icon","setIcon","scaledSize","Size","Marker","animation","Animation","DROP","draggable","optimized","zIndex","MAX_ZINDEX","infoWindow","InfoWindow","content","disableAutoPan","addListeners","event","newLocation","getPosition","updateSearchMarker","oldLocation","changeSearchLocation","done","fail","setPosition","searchControlURI","action","post","encodeURIComponent","toggleClass","updateSearchStatus","getJSON","then","data","status","toggle","elSearchBox","searchBox","places","Autocomplete","css","place","getPlace","geometry","location","length","setInterval","getTypeSpan","type","openMapDirections","window","open","getDateStr","t","dateStr","moment","fromNow","pokemonLabel","item","rarityDisplay","types","typesDisplay","latitude","longitude","disappearTime","atk","def","sta","pMove1","undefined","i8ln","pMove2","weight","height","gender","form","cp","cpMultiplier","each","index","details","contentstring","formString","pokemonLevel","getPokemonLevel","iv","getIv","toFixed","isOngoingRaid","raid","now","end","start","isValidRaid","spawn","isGymSatisfiesRaidMinMaxFilter","gymLabel","gym","includeMembers","pokemonWithImages","raidStr","pokemon_id","toLowerCase","lastScannedStr","last_scanned","lastModifiedStr","last_modified","slotsString","slots_available","teamColor","teamName","team_id","isUpcomingRaid","isRaidStarted","isRaidFilterOn","subtitle","image","imageLbl","navInfo","memberStr","gymPoints","total_cp","titleText","title","raidColor","levelStr","repeat","level","Math","floor","indexOf","getGymLevel","pokemon","forEach","member","pokemon_name","cp_decayed","pokestopLabel","expireTime","str","formatSpawnTime","seconds","substr","spawnpointLabel","uncertain","appear_time","disappear_time","addRangeCircle","teamId","targetmap","circleCenter","LatLng","gymColors","range","circleColor","rangeCircleOpts","radius","strokeWeight","strokeColor","strokeOpacity","fillColor","fillOpacity","Circle","isRangeActive","stm","round","getRaidLevel","lpad","len","padstr","Array","max","String","join","repArray","text","find","replace","i","getTimeUntil","time","tdiff","sec","min","hour","getNotifyText","ntitle","dist","format","until","udist","ntext","playPokemonSound","pokemonID","play","filetype","shift","audioCry","catch","err","console","log","isNotifyPoke","poke","isOnNotifyList","hasHighIV","perfection","customizePokemonMarker","skipNotification","setAnimation","animationDisabled","sendNotification","fav_title","fav_text","BOUNCE","setupGymMarker","updateGymMarker","gymSidebar","querySelector","getAttribute","classList","contains","remove","setAttribute","showGymDetails","persist","isMobileDevice","isTouchDevice","clearSelection","updateLabelDiffTime","close","raidLevel","markerImage","setZIndex","setContent","setupPokestopMarker","imagename","getColorByDate","value","diff","hue","toString","setupScannedMarker","clickable","showConfig","getColorBySpawnTime","getMinutes","getSeconds","changeSpawnIcon","color","urlColor","zoomScale","minimumSize","newSize","newIcon","anchor","Point","spawnPointIndex","newIndex","scale","setupSpawnpointMarker","selection","empty","getSelection","removeAllRanges","infoWindowIsOpen","clearStaleMarkers","oldPokeMarkers","key","isPokeExpired","isPokeExcluded","oldMarker","push","removeMarkers","getTime","scanned","showInBoundsMarkers","markers","show","getBounds","intersects","getMap","oldAnimation","getAnimation","loadRawData","loadPokemon","loadGyms","loadPokestops","loadScanned","loadSpawnpoints","loadLuredOnly","Boolean","bounds","swPoint","getSouthWest","nePoint","getNorthEast","swLat","swLng","neLat","neLng","ajax","dataType","cache","beforeSend","error","toastr","options","complete","processPokemons","processPokemonChunked","chunkSize","oldMarkers","newMarkers","chunk","splice","encounter_id","expiringSoon","hasOwnProperty","processPokemon","newMarker","addMarkers","isExcludedPoke","isPokeAlive","updatePokemonMarker","setupPokemonMarker","processPokestop","pokestops","item2","updatePokestops","removeStops","currentTime","processGym","gymLevel","removeGymFromMap","gymid","gyms","processScanned","scanId","updateScanned","setOptions","processSpawnpoint","spawnpoints","updateSpawnPoints","result","repaint","hasClass","countMarkers","filter","e","pokemonList","element","disappearsAt","parseInt","hours","minutes","timestring","ttime","getPointDistance","pointA","pointB","spherical","computeDistanceBetween","Notification","permission","requestPermission","notification","body","sound","onclick","focus","centerMap","locationContainer","createElement","locationButton","backgroundColor","border","outline","width","borderRadius","boxShadow","cursor","marginRight","padding","appendChild","locationIcon","margin","backgroundImage","backgroundSize","backgroundPosition","backgroundRepeat","addEventListener","centerMapOnLocation","controls","RIGHT_BOTTOM","currentLocation","imgX","animationInterval","navigator","geolocation","getCurrentPosition","latlng","coords","setCenter","clearInterval","setZoom","word","isEmptyObject","async","success","jqXHR","updateGeoLocation","panTo","createUpdateWorker","Worker","updateBlob","Blob","updateBlobURL","URL","createObjectURL","onmessage","postMessage","ex","message","sidebar","sidebarClose","add","pokemonHtml","getSidebarGymMember","guard_pokemon_id","guard_pokemon_name","topPart","innerHTML","href","className","tabIndex","preventDefault","stopPropagation","perfectPercent","iv_attack","iv_defense","iv_stamina","moveEnergy","move_2_energy","trainer_name","trainer_level","deployment_time","move_1_name","move_1_type","move_1_damage","move_2_name","move_2_type","move_2_damage","toggleGymPokemonDetails","lastElementChild","firstElementChild","nextElementSibling","search","regex","RegExp","results","exec","decodeURIComponent","styleList","select2","placeholder","minimumResultsForSearch","Infinity","d","dType","searchMarkerStyleList","selectSearchIconMarker","locale","formatState","state","$state","numberOfPokemon","pokeList","_types","pokemonType","templateResult","isNaN","buildSwitchChangeListener","storageKey","change","wrapper","hide","wrapper2","bind","criesWrapper","setDraggable","alert","accordion","active","collapsible","heightStyle","DataTable","paging","searching","info","errMode","order"],"mappings":"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","file":"map.built.js","sourcesContent":["//\n// Global map.js variables\n//\n\nvar $selectExclude\nvar $selectPokemonNotify\nvar $selectRarityNotify\nvar $textPerfectionNotify\nvar $selectStyle\nvar $selectIconSize\nvar $switchOpenGymsOnly\nvar $switchActiveRaidGymsOnly\nvar $switchRaidMinLevel\nvar $switchRaidMaxLevel\nvar $selectTeamGymsOnly\nvar $selectLastUpdateGymsOnly\nvar $selectMinGymLevel\nvar $selectMaxGymLevel\nvar $selectLuredPokestopsOnly\nvar $selectSearchIconMarker\nvar $selectLocationIconMarker\nvar $switchGymSidebar\n\nconst language = document.documentElement.lang === '' ? 'en' : document.documentElement.lang\nvar idToPokemon = {}\nvar i8lnDictionary = {}\nvar languageLookups = 0\nvar languageLookupThreshold = 3\n\nvar searchMarkerStyles\n\nvar timestamp\nvar excludedPokemon = []\nvar notifiedPokemon = []\nvar notifiedRarity = []\nvar notifiedMinPerfection = null\n\nvar buffer = []\nvar reincludedPokemon = []\nvar reids = []\n\nvar map\nvar markerCluster\nvar rawDataIsLoading = false\nvar locationMarker\nconst rangeMarkers = ['pokemon', 'pokestop', 'gym']\nvar searchMarker\nvar storeZoom = true\nvar moves\n\nvar oSwLat\nvar oSwLng\nvar oNeLat\nvar oNeLng\n\nvar lastpokestops\nvar lastgyms\nvar lastpokemon\nvar lastslocs\nvar lastspawns\n\nvar selectedStyle = 'light'\n\nvar updateWorker\nvar lastUpdateTime\nvar redrawTimeout = null\n\nconst gymTypes = ['Uncontested', 'Mystic', 'Valor', 'Instinct']\n\nconst audio = new Audio('static/sounds/ding.mp3')\nconst cryFileTypes = ['wav', 'mp3']\n\nconst genderType = ['', '', '']\nconst unownForm = ['unset', 'A', 'B', 'C', 'D', 'E', 'F', 'G', 'H', 'I', 'J', 'K', 'L', 'M', 'N', 'O', 'P', 'Q', 'R', 'S', 'T', 'U', 'V', 'W', 'X', 'Y', 'Z', '!', '?']\n\n\n/*\n text place holders:\n <pkm> - pokemon name\n <prc> - iv in percent without percent symbol\n <atk> - attack as number\n <def> - defense as number\n <sta> - stamnia as number\n */\nvar notifyIvTitle = '<pkm> <prc>% (<atk>/<def>/<sta>)'\nvar notifyNoIvTitle = '<pkm>'\n\n/*\n text place holders:\n <dist>  - disappear time\n <udist> - time until disappear\n */\nvar notifyText = 'disappears at <dist> (<udist>)'\n\n//\n// Functions\n//\n\nfunction excludePokemon(id) { // eslint-disable-line no-unused-vars\n    $selectExclude.val(\n        $selectExclude.val().concat(id)\n    ).trigger('change')\n}\n\nfunction notifyAboutPokemon(id) { // eslint-disable-line no-unused-vars\n    $selectPokemonNotify.val(\n        $selectPokemonNotify.val().concat(id)\n    ).trigger('change')\n}\n\nfunction removePokemonMarker(encounterId) { // eslint-disable-line no-unused-vars\n    if (mapData.pokemons[encounterId].marker.rangeCircle) {\n        mapData.pokemons[encounterId].marker.rangeCircle.setMap(null)\n        delete mapData.pokemons[encounterId].marker.rangeCircle\n    }\n    mapData.pokemons[encounterId].marker.setMap(null)\n    mapData.pokemons[encounterId].hidden = true\n}\n\nfunction initMap() { // eslint-disable-line no-unused-vars\n    map = new google.maps.Map(document.getElementById('map'), {\n        center: {\n            lat: Number(getParameterByName('lat')) || centerLat,\n            lng: Number(getParameterByName('lon')) || centerLng\n        },\n        zoom: Number(getParameterByName('zoom')) || Store.get('zoomLevel'),\n        fullscreenControl: true,\n        streetViewControl: false,\n        mapTypeControl: false,\n        clickableIcons: false,\n        mapTypeControlOptions: {\n            style: google.maps.MapTypeControlStyle.DROPDOWN_MENU,\n            position: google.maps.ControlPosition.RIGHT_TOP,\n            mapTypeIds: [\n                google.maps.MapTypeId.ROADMAP,\n                google.maps.MapTypeId.SATELLITE,\n                google.maps.MapTypeId.HYBRID,\n                'nolabels_style',\n                'dark_style',\n                'style_light2',\n                'style_pgo',\n                'dark_style_nl',\n                'style_light2_nl',\n                'style_pgo_nl',\n                'style_pgo_day',\n                'style_pgo_night',\n                'style_pgo_dynamic'\n            ]\n        }\n    })\n\n    // Enable clustering.\n    var clusterOptions = {\n        imagePath: 'static/images/cluster/m',\n        maxZoom: Store.get('maxClusterZoomLevel'),\n        zoomOnClick: Store.get('clusterZoomOnClick'),\n        gridSize: Store.get('clusterGridSize')\n    }\n\n    markerCluster = new MarkerClusterer(map, [], clusterOptions)\n\n    var styleNoLabels = new google.maps.StyledMapType(noLabelsStyle, {\n        name: 'No Labels'\n    })\n    map.mapTypes.set('nolabels_style', styleNoLabels)\n\n    var styleDark = new google.maps.StyledMapType(darkStyle, {\n        name: 'Dark'\n    })\n    map.mapTypes.set('dark_style', styleDark)\n\n    var styleLight2 = new google.maps.StyledMapType(light2Style, {\n        name: 'Light2'\n    })\n    map.mapTypes.set('style_light2', styleLight2)\n\n    var stylePgo = new google.maps.StyledMapType(pGoStyle, {\n        name: 'RocketMap'\n    })\n    map.mapTypes.set('style_pgo', stylePgo)\n\n    var styleDarkNl = new google.maps.StyledMapType(darkStyleNoLabels, {\n        name: 'Dark (No Labels)'\n    })\n    map.mapTypes.set('dark_style_nl', styleDarkNl)\n\n    var styleLight2Nl = new google.maps.StyledMapType(light2StyleNoLabels, {\n        name: 'Light2 (No Labels)'\n    })\n    map.mapTypes.set('style_light2_nl', styleLight2Nl)\n\n    var stylePgoNl = new google.maps.StyledMapType(pGoStyleNoLabels, {\n        name: 'RocketMap (No Labels)'\n    })\n    map.mapTypes.set('style_pgo_nl', stylePgoNl)\n\n    var stylePgoDay = new google.maps.StyledMapType(pGoStyleDay, {\n        name: 'RocketMap Day'\n    })\n    map.mapTypes.set('style_pgo_day', stylePgoDay)\n\n    var stylePgoNight = new google.maps.StyledMapType(pGoStyleNight, {\n        name: 'RocketMap Night'\n    })\n    map.mapTypes.set('style_pgo_night', stylePgoNight)\n\n    // dynamic map style chooses stylePgoDay or stylePgoNight depending on client time\n    var currentDate = new Date()\n    var currentHour = currentDate.getHours()\n    var stylePgoDynamic = (currentHour >= 6 && currentHour < 19) ? stylePgoDay : stylePgoNight\n    map.mapTypes.set('style_pgo_dynamic', stylePgoDynamic)\n\n    map.addListener('maptypeid_changed', function (s) {\n        Store.set('map_style', this.mapTypeId)\n    })\n\n    map.setMapTypeId(Store.get('map_style'))\n    map.addListener('idle', updateMap)\n\n    map.addListener('zoom_changed', function () {\n        if (storeZoom === true) {\n            Store.set('zoomLevel', this.getZoom())\n        } else {\n            storeZoom = true\n        }\n\n        // User scrolled again, reset our timeout.\n        if (redrawTimeout) {\n            clearTimeout(redrawTimeout)\n            redrawTimeout = null\n        }\n\n        // Don't redraw constantly even if the user scrolls multiple times,\n        // just add it on a timer.\n        redrawTimeout = setTimeout(function () {\n            redrawPokemon(mapData.pokemons)\n            redrawPokemon(mapData.lurePokemons)\n\n            // We're done processing the list. Redraw.\n            markerCluster.resetViewport()\n            markerCluster.redraw()\n        }, 500)\n    })\n\n    searchMarker = createSearchMarker()\n    locationMarker = createLocationMarker()\n    createMyLocationButton()\n    initSidebar()\n\n    $('#scan-here').on('click', function () {\n        var loc = map.getCenter()\n        changeLocation(loc.lat(), loc.lng())\n\n        if (!$('#search-switch').checked) {\n            $('#search-switch').prop('checked', true)\n            searchControl('on')\n        }\n    })\n}\n\nfunction updateLocationMarker(style) {\n    if (style in searchMarkerStyles) {\n        var url = searchMarkerStyles[style].icon\n        if (url) {\n            locationMarker.setIcon({\n                url: url,\n                scaledSize: new google.maps.Size(24, 24)\n            })\n        } else {\n            locationMarker.setIcon(url)\n        }\n        Store.set('locationMarkerStyle', style)\n    }\n\n    return locationMarker\n}\n\nfunction createLocationMarker() {\n    var position = Store.get('followMyLocationPosition')\n    var lat = ('lat' in position) ? position.lat : centerLat\n    var lng = ('lng' in position) ? position.lng : centerLng\n\n    var locationMarker = new google.maps.Marker({\n        map: map,\n        animation: google.maps.Animation.DROP,\n        position: {\n            lat: lat,\n            lng: lng\n        },\n        draggable: true,\n        icon: null,\n        optimized: false,\n        zIndex: google.maps.Marker.MAX_ZINDEX + 2\n    })\n\n    locationMarker.infoWindow = new google.maps.InfoWindow({\n        content: '<div><b>My Location</b></div>',\n        disableAutoPan: true\n    })\n\n    addListeners(locationMarker)\n\n    google.maps.event.addListener(locationMarker, 'dragend', function () {\n        var newLocation = locationMarker.getPosition()\n        Store.set('followMyLocationPosition', {\n            lat: newLocation.lat(),\n            lng: newLocation.lng()\n        })\n    })\n\n    return locationMarker\n}\n\nfunction updateSearchMarker(style) {\n    if (style in searchMarkerStyles) {\n        var url = searchMarkerStyles[style].icon\n        if (url) {\n            searchMarker.setIcon({\n                url: url,\n                scaledSize: new google.maps.Size(24, 24)\n            })\n        } else {\n            searchMarker.setIcon(url)\n        }\n        Store.set('searchMarkerStyle', style)\n    }\n\n    return searchMarker\n}\n\nfunction createSearchMarker() {\n    var searchMarker = new google.maps.Marker({ // need to keep reference.\n        position: {\n            lat: centerLat,\n            lng: centerLng\n        },\n        map: map,\n        animation: google.maps.Animation.DROP,\n        draggable: !Store.get('lockMarker'),\n        icon: null,\n        optimized: false,\n        zIndex: google.maps.Marker.MAX_ZINDEX + 1\n    })\n\n    searchMarker.infoWindow = new google.maps.InfoWindow({\n        content: '<div><b>Search Location</b></div>',\n        disableAutoPan: true\n    })\n\n    addListeners(searchMarker)\n\n    var oldLocation = null\n    google.maps.event.addListener(searchMarker, 'dragstart', function () {\n        oldLocation = searchMarker.getPosition()\n    })\n\n    google.maps.event.addListener(searchMarker, 'dragend', function () {\n        var newLocation = searchMarker.getPosition()\n        changeSearchLocation(newLocation.lat(), newLocation.lng())\n            .done(function () {\n                oldLocation = null\n            })\n            .fail(function () {\n                if (oldLocation) {\n                    searchMarker.setPosition(oldLocation)\n                }\n            })\n    })\n\n    return searchMarker\n}\n\nvar searchControlURI = 'search_control'\n\nfunction searchControl(action) {\n    $.post(searchControlURI + '?action=' + encodeURIComponent(action))\n    $('#scan-here').toggleClass('disabled', action === 'off')\n}\n\nfunction updateSearchStatus() {\n    $.getJSON(searchControlURI).then(function (data) {\n        $('#search-switch').prop('checked', data.status)\n        $('#scan-here').toggleClass('disabled', !data.status)\n    })\n}\n\nfunction initSidebar() {\n    $('#gyms-switch').prop('checked', Store.get('showGyms'))\n    $('#gym-sidebar-switch').prop('checked', Store.get('useGymSidebar'))\n    $('#gym-sidebar-wrapper').toggle(Store.get('showGyms'))\n    $('#gyms-filter-wrapper').toggle(Store.get('showGyms'))\n    $('#team-gyms-only-switch').val(Store.get('showTeamGymsOnly'))\n    $('#raids-switch').prop('checked', Store.get('showRaids'))\n    $('#raid-active-gym-switch').prop('checked', Store.get('showActiveRaidsOnly'))\n    $('#raid-min-level-only-switch').val(Store.get('showRaidMinLevel'))\n    $('#raid-max-level-only-switch').val(Store.get('showRaidMaxLevel'))\n    $('#raids-filter-wrapper').toggle(Store.get('showRaids'))\n    $('#open-gyms-only-switch').prop('checked', Store.get('showOpenGymsOnly'))\n    $('#min-level-gyms-filter-switch').val(Store.get('minGymLevel'))\n    $('#max-level-gyms-filter-switch').val(Store.get('maxGymLevel'))\n    $('#last-update-gyms-switch').val(Store.get('showLastUpdatedGymsOnly'))\n    $('#pokemon-switch').prop('checked', Store.get('showPokemon'))\n    $('#pokestops-switch').prop('checked', Store.get('showPokestops'))\n    $('#lured-pokestops-only-switch').val(Store.get('showLuredPokestopsOnly'))\n    $('#lured-pokestops-only-wrapper').toggle(Store.get('showPokestops'))\n    $('#geoloc-switch').prop('checked', Store.get('geoLocate'))\n    $('#lock-marker-switch').prop('checked', Store.get('lockMarker'))\n    $('#start-at-user-location-switch').prop('checked', Store.get('startAtUserLocation'))\n    $('#follow-my-location-switch').prop('checked', Store.get('followMyLocation'))\n    $('#scan-here-switch').prop('checked', Store.get('scanHere'))\n    $('#scan-here').toggle(Store.get('scanHere'))\n    $('#scanned-switch').prop('checked', Store.get('showScanned'))\n    $('#spawnpoints-switch').prop('checked', Store.get('showSpawnpoints'))\n    $('#ranges-switch').prop('checked', Store.get('showRanges'))\n    $('#sound-switch').prop('checked', Store.get('playSound'))\n    $('#pokemoncries').toggle(Store.get('playSound'))\n    $('#cries-switch').prop('checked', Store.get('playCries'))\n\n    // Only create the Autocomplete element if it's enabled in template.\n    var elSearchBox = document.getElementById('next-location')\n\n    if (elSearchBox) {\n        var searchBox = new google.maps.places.Autocomplete(elSearchBox)\n        $(elSearchBox).css('background-color', $('#geoloc-switch').prop('checked') ? '#e0e0e0' : '#ffffff')\n\n        searchBox.addListener('place_changed', function () {\n            var place = searchBox.getPlace()\n\n            if (!place.geometry) return\n\n            var loc = place.geometry.location\n            changeLocation(loc.lat(), loc.lng())\n        })\n    }\n\n    if ($('#search-switch').length) {\n        updateSearchStatus()\n        setInterval(updateSearchStatus, 5000)\n    }\n\n    $('#pokemon-icon-size').val(Store.get('iconSizeModifier'))\n}\n\nfunction getTypeSpan(type) {\n    return `<span style='padding: 2px 5px; text-transform: uppercase; color: white; margin-right: 2px; border-radius: 4px; font-size: 0.6em; vertical-align: middle; background-color: ${type['color']}'>${type['type']}</span>`\n}\n\nfunction openMapDirections(lat, lng) { // eslint-disable-line no-unused-vars\n    var url = 'https://www.google.com/maps/?daddr=' + lat + ',' + lng\n    window.open(url, '_blank')\n}\n\n// Converts timestamp to readable String\nfunction getDateStr(t) {\n    var dateStr = 'Unknown'\n    if (t) {\n        dateStr = moment(t).fromNow()\n    }\n    return dateStr\n}\n\nfunction pokemonLabel(item) {\n    var name = item['pokemon_name']\n    var rarityDisplay = item['pokemon_rarity'] ? '(' + item['pokemon_rarity'] + ')' : ''\n    var types = item['pokemon_types']\n    var typesDisplay = ''\n    var encounterId = item['encounter_id']\n    var id = item['pokemon_id']\n    var latitude = item['latitude']\n    var longitude = item['longitude']\n    var disappearTime = item['disappear_time']\n    var atk = item['individual_attack']\n    var def = item['individual_defense']\n    var sta = item['individual_stamina']\n    var pMove1 = (moves[item['move_1']] !== undefined) ? i8ln(moves[item['move_1']]['name']) : 'gen/unknown'\n    var pMove2 = (moves[item['move_2']] !== undefined) ? i8ln(moves[item['move_2']]['name']) : 'gen/unknown'\n    var weight = item['weight']\n    var height = item['height']\n    var gender = item['gender']\n    var form = item['form']\n    var cp = item['cp']\n    var cpMultiplier = item['cp_multiplier']\n\n    $.each(types, function (index, type) {\n        typesDisplay += getTypeSpan(type)\n    })\n\n    var details = ''\n\n    var contentstring = ''\n    var formString = ''\n\n    if (id === 201 && form !== null && form > 0) {\n        formString += `(${unownForm[item['form']]})`\n    }\n\n    contentstring += `\n    <div class='pokemon name'>\n      ${name} <span class='pokemon name pokedex'><a href='http://pokemon.gameinfo.io/en/pokemon/${id}' target='_blank' title='View in Pokdex'>#${id}</a></span> ${formString} <span class='pokemon gender rarity'>${genderType[gender - 1]} ${rarityDisplay}</span> ${typesDisplay}\n    </div>`\n\n    if (cp !== null && cpMultiplier !== null) {\n        var pokemonLevel = getPokemonLevel(cpMultiplier)\n\n        if (atk !== null && def !== null && sta !== null) {\n            var iv = getIv(atk, def, sta)\n        }\n\n        contentstring += `\n          <div class='pokemon container'>\n            <div class='pokemon container content-left'>\n              <div>\n                <img class='pokemon sprite' src='static/icons/${id}.png'>\n                <span class='pokemon'>Level: </span><span class='pokemon'>${pokemonLevel}</span>\n                <span class='pokemon links exclude'><a href='javascript:excludePokemon(${id})'>Exclude</a></span>\n                <span class='pokemon links notify'><a href='javascript:notifyAboutPokemon(${id})'>Notify</a></span>\n                <span class='pokemon links remove'><a href='javascript:removePokemonMarker(\"${encounterId}\")'>Remove</a></span>\n              </div>\n          </div>\n          <div class='pokemon container content-right'>\n            <div>\n              <div class='pokemon disappear'>\n                <span class='label-countdown' disappears-at='${disappearTime}'>00m00s</span> left\n              </div>\n              <div class='pokemon'>\n                CP: <span class='pokemon encounter'>${cp}/${iv.toFixed(1)}%</span> (A${atk}/D${def}/S${sta})\n              </div>\n              <div class='pokemon'>\n                Moveset: <span class='pokemon encounter'>${pMove1}/${pMove2}</span>\n              </div>\n              <div class='pokemon'>\n                Weight: ${weight.toFixed(2)}kg | Height: ${height.toFixed(2)}m\n              </div>\n              <div>\n                <span class='pokemon navigate'><a href='javascript:void(0);' onclick='javascript:openMapDirections(${latitude},${longitude});' title='Open in Google Maps'>${latitude.toFixed(6)}, ${longitude.toFixed(7)}</a></span>\n              </div>\n          </div>\n        </div>\n      </div>`\n    } else {\n        contentstring += `\n      <div class='pokemon container'>\n        <div class='pokemon container content-left'>\n          <div>\n            <img class='pokemon sprite' src='static/icons/${id}.png'>\n            <span class='pokemon'>Level: </span><span class='pokemon no-encounter'>n/a</span>\n            <span class='pokemon links exclude'><a href='javascript:excludePokemon(${id})'>Exclude</a></span>\n            <span class='pokemon links notify'><a href='javascript:notifyAboutPokemon(${id})'>Notify</a></span>\n            <span class='pokemon links remove'><a href='javascript:removePokemonMarker(\"${encounterId}\")'>Remove</a></span>\n          </div>\n      </div>\n      <div class='pokemon container content-right'>\n        <div>\n          <div class='pokemon disappear'>\n            <span class='label-countdown' disappears-at='${disappearTime}'>00m00s</span> left\n          </div>\n          <div class='pokemon'>\n            CP: <span class='pokemon no-encounter'>No information</span>\n          </div>\n          <div class='pokemon'>\n            Moveset: <span class='pokemon no-encounter'>No information</span>\n          </div>\n          <div class='pokemon'>\n            Weight: <span class='pokemon no-encounter'>n/a</span> | Height: <span class='pokemon no-encounter'>n/a</span>\n          </div>\n          <div>\n            <span class='pokemon navigate'><a href='javascript:void(0);' onclick='javascript:openMapDirections(${latitude},${longitude});' title='Open in Google Maps'>${latitude.toFixed(6)}, ${longitude.toFixed(7)}</a></span>\n          </div>\n      </div>\n    </div>\n  </div>`\n    }\n\n    contentstring += `\n      ${details}`\n\n    return contentstring\n}\n\nfunction isOngoingRaid(raid) {\n    return raid && Date.now() < raid.end && Date.now() > raid.start\n}\n\nfunction isValidRaid(raid) {\n    return raid && Date.now() < raid.end && Date.now() > raid.spawn\n}\n\nfunction isGymSatisfiesRaidMinMaxFilter(raid) {\n    if (raid === null) {\n        return 0\n    } else {\n        return (raid['level'] <= Store.get('showRaidMaxLevel') && raid['level'] >= Store.get('showRaidMinLevel')) ? 1 : 0\n    }\n}\n\nfunction gymLabel(gym, includeMembers = true) {\n    const pokemonWithImages = [\n        3, 6, 9, 59, 65, 68, 89, 94, 103, 110, 112, 125, 126, 129, 131, 134,\n        135, 136, 143, 144, 145, 146, 153, 156, 159, 248, 249\n    ]\n\n    const raid = gym.raid\n    var raidStr = ''\n    if (raid && raid.end > Date.now()) {\n        if (raid.pokemon_id !== null) {\n            let pMove1 = (moves[raid['move_1']] !== undefined) ? i8ln(moves[raid['move_1']]['name']) : 'unknown'\n            let pMove2 = (moves[raid['move_2']] !== undefined) ? i8ln(moves[raid['move_2']]['name']) : 'unknown'\n\n            raidStr += `\n                    <div class='move'>\n                      <span class='name'>${pMove1}</span><span class='type ${moves[raid['move_1']]['type'].toLowerCase()}'>${i8ln(moves[raid['move_1']]['type'])}</span>\n                    </div>\n                    <div class='move'>\n                      <span class='name'>${pMove2}</span><span class='type ${moves[raid['move_2']]['type'].toLowerCase()}'>${i8ln(moves[raid['move_2']]['type'])}</span>\n                    </div>`\n        }\n    }\n    const lastScannedStr = getDateStr(gym.last_scanned)\n    const lastModifiedStr = getDateStr(gym.last_modified)\n    const slotsString = gym.slots_available ? (gym.slots_available === 1 ? '1 Free Slot' : `${gym.slots_available} Free Slots`) : 'No Free Slots'\n    const teamColor = ['85,85,85,1', '0,134,255,1', '255,26,26,1', '255,159,25,1']\n    const teamName = gymTypes[gym.team_id]\n    const isUpcomingRaid = raid != null && Date.now() < raid.start\n    const isRaidStarted = isOngoingRaid(raid)\n    const isRaidFilterOn = Store.get('showRaids')\n\n    var subtitle = ''\n    var image = ''\n    var imageLbl = ''\n    var navInfo = ''\n    var memberStr = ''\n\n    const gymPoints = gym.total_cp\n    const titleText = gym.name ? gym.name : (gym.team_id === 0 ? teamName : 'Team ' + teamName)\n    const title = `\n      <div class='gym name' style='color:rgba(${teamColor[gym.team_id]})'>\n        ${titleText}\n      </div>`\n\n    if (gym.team_id !== 0) {\n        subtitle = `\n        <div>\n            <img class='gym info strength' src='static/images/gym/Strength.png'>\n            <span class='gym info strength'>\n              Strength: ${gymPoints} (${slotsString})\n            </span>\n        </div>`\n    }\n\n    if ((isUpcomingRaid || isRaidStarted) && isRaidFilterOn && isGymSatisfiesRaidMinMaxFilter(raid)) {\n        const raidColor = ['252,112,176', '255,158,22', '184,165,221']\n        const levelStr = ''.repeat(raid['level'])\n\n        if (isRaidStarted) {\n            // Set default image.\n            image = `\n                <img class='gym sprite' src='static/images/raid/${gymTypes[gym.team_id]}_${raid.level}_unknown.png'>\n                <div class='raid'>\n                <span style='color:rgb(${raidColor[Math.floor((raid.level - 1) / 2)]})'>\n                ${levelStr}\n                </span>\n                <span class='raid countdown label-countdown' disappears-at='${raid.end}'></span> left\n                </div>\n            `\n            // Use Pokmon-specific image if we have one.\n            if (raid.pokemon_id !== null && pokemonWithImages.indexOf(raid.pokemon_id) !== -1) {\n                image = `\n                    <div class='raid container'>\n                    <div class='raid container content-left'>\n                        <div>\n                        <img class='gym sprite' src='static/icons/${raid.pokemon_id}.png'>\n                        </div>\n                    </div>\n                    <div class='raid container content-right'>\n                        <div>\n                        <div class='raid pokemon'>\n                            ${raid['pokemon_name']} <a href='http://pokemon.gameinfo.io/en/pokemon/${raid['pokemon_id']}' target='_blank' title='View in Pokdex'>#${raid['pokemon_id']}</a> | CP: ${raid['cp']}\n                    </div>\n                        ${raidStr}\n                    </div>\n                    </div>\n                </div>\n                    <div class='raid'>\n                    <span style='color:rgb(${raidColor[Math.floor((raid.level - 1) / 2)]})'>\n                    ${levelStr}\n                    </span>\n                    <span class='raid countdown label-countdown' disappears-at='${raid.end}'></span> left\n                    </div>\n                `\n            }\n        } else {\n            image = `<img class='gym sprite' src='static/images/gym/${gymTypes[gym.team_id]}_${getGymLevel(gym)}_${raid.level}.png'>`\n        }\n\n        if (isUpcomingRaid) {\n            imageLbl = `\n                <div class='raid'>\n                  <span style='color:rgb(${raidColor[Math.floor((raid.level - 1) / 2)]})'>\n                  ${levelStr}\n                  </span>\n                  Raid in <span class='raid countdown label-countdown' disappears-at='${raid.start}'></span>\n                </div>`\n        }\n    } else {\n        image = `<img class='gym sprite' src='static/images/gym/${teamName}_${getGymLevel(gym)}.png'>`\n    }\n\n\n    navInfo = `\n            <div class='gym container'>\n                <div>\n                  <span class='gym info navigate'>\n                    <a href='javascript:void(0);' onclick='javascript:openMapDirections(${gym.latitude},${gym.longitude});' title='Open in Google Maps'>\n                      ${gym.latitude.toFixed(6)}, ${gym.longitude.toFixed(7)}\n                    </a>\n                  </span>\n                </div>\n                <div class='gym info last-scanned'>\n                    Last Scanned: ${lastScannedStr}\n                </div>\n                <div class='gym info last-modified'>\n                    Last Modified: ${lastModifiedStr}\n                </div>\n            </div>\n        </div>`\n\n\n    if (includeMembers) {\n        memberStr = '<div>'\n\n        gym.pokemon.forEach((member) => {\n            memberStr += `\n            <span class='gym member'>\n              <center>\n                <div>\n                  <div>\n                    <i class='pokemon-sprite n${member.pokemon_id}'></i>\n                  </div>\n                  <div>\n                    <span class='gym pokemon'>${member.pokemon_name}</span>\n                  </div>\n                  <div>\n                    <img class='gym pokemon motivation heart' src='static/images/gym/Heart.png'> <span class='gym pokemon motivation'>${member.cp_decayed}</span>\n                  </div>\n                </div>\n              </center>\n            </span>`\n        })\n\n        memberStr += '</div>'\n    }\n\n    return `\n        <div>\n            <center>\n                ${title}\n                ${subtitle}\n                ${image}\n                ${imageLbl}\n            </center>\n            ${navInfo}\n            <center>\n                ${memberStr}\n            </center>\n        </div>`\n}\n\nfunction pokestopLabel(expireTime, latitude, longitude) {\n    var str\n    if (expireTime) {\n        str = `\n            <div>\n              <div class='pokestop lure'>\n                Lured Pokstop\n              </div>\n              <div class='pokestop-expire'>\n                  <span class='label-countdown' disappears-at='${expireTime}'>00m00s</span> left\n              </div>\n              <div>\n                <img class='pokestop sprite' src='static/images/pokestop//PokestopLured.png'>\n              </div>\n              <div>\n                <span class='pokestop navigate'><a href='javascript:void(0);' onclick='javascript:openMapDirections(${latitude},${longitude});' title='Open in Google Maps'; class='pokestop lure'>${latitude.toFixed(6)}, ${longitude.toFixed(7)}</a></span>\n              </div>\n            </div>\n          </div>`\n    } else {\n        str = `\n            <div>\n              <div class='pokestop nolure'>\n                Pokstop\n              </div>\n              <div>\n                <img class='pokestop sprite' src='static/images/pokestop//Pokestop.png'>\n              </div>\n              <div>\n                <span class='pokestop navigate'><a href='javascript:void(0);' onclick='javascript:openMapDirections(${latitude},${longitude});' title='Open in Google Maps'; class='pokestop nolure'>${latitude.toFixed(6)}, ${longitude.toFixed(7)}</a></span>\n              </div>\n            </div>\n          </div>`\n    }\n\n    return str\n}\n\nfunction formatSpawnTime(seconds) {\n    // the addition and modulo are required here because the db stores when a spawn disappears\n    // the subtraction to get the appearance time will knock seconds under 0 if the spawn happens in the previous hour\n    return ('0' + Math.floor(((seconds + 3600) % 3600) / 60)).substr(-2) + ':' + ('0' + seconds % 60).substr(-2)\n}\n\nfunction spawnpointLabel(item) {\n    var str = `\n        <div>\n            <b>Spawn Point</b>\n        </div>`\n\n    if (item.uncertain) {\n        str += `\n            <div>\n                Spawn times not yet determined. Current guess ${formatSpawnTime(item.appear_time)} until ${formatSpawnTime(item.disappear_time)}\n            </div>`\n    } else {\n        str += `\n            <div>\n                Every hour from ${formatSpawnTime(item.appear_time)} to ${formatSpawnTime(item.disappear_time)}\n            </div>`\n    }\n    return str\n}\n\nfunction addRangeCircle(marker, map, type, teamId) {\n    var targetmap = null\n    var circleCenter = new google.maps.LatLng(marker.position.lat(), marker.position.lng())\n    var gymColors = ['#999999', '#0051CF', '#FF260E', '#FECC23'] // 'Uncontested', 'Mystic', 'Valor', 'Instinct']\n    var teamColor = gymColors[0]\n    if (teamId) teamColor = gymColors[teamId]\n\n    var range\n    var circleColor\n\n    // handle each type of marker and be explicit about the range circle attributes\n    switch (type) {\n        case 'pokemon':\n            circleColor = '#C233F2'\n            range = 40 // pokemon appear at 40m and then you can move away. still have to be 40m close to see it though, so ignore the further disappear distance\n            break\n        case 'pokestop':\n            circleColor = '#3EB0FF'\n            range = 40\n            break\n        case 'gym':\n            circleColor = teamColor\n            range = 40\n            break\n    }\n\n    if (map) targetmap = map\n\n    var rangeCircleOpts = {\n        map: targetmap,\n        radius: range, // meters\n        strokeWeight: 1,\n        strokeColor: circleColor,\n        strokeOpacity: 0.9,\n        center: circleCenter,\n        fillColor: circleColor,\n        fillOpacity: 0.3\n    }\n    var rangeCircle = new google.maps.Circle(rangeCircleOpts)\n    return rangeCircle\n}\n\nfunction isRangeActive(map) {\n    if (map.getZoom() < 16) return false\n    return Store.get('showRanges')\n}\n\nfunction getIv(atk, def, stm) {\n    if (atk !== null) {\n        return 100.0 * (atk + def + stm) / 45\n    }\n\n    return false\n}\n\nfunction getPokemonLevel(cpMultiplier) {\n    if (cpMultiplier < 0.734) {\n        var pokemonLevel = (58.35178527 * cpMultiplier * cpMultiplier -\n        2.838007664 * cpMultiplier + 0.8539209906)\n    } else {\n        pokemonLevel = 171.0112688 * cpMultiplier - 95.20425243\n    }\n    pokemonLevel = (Math.round(pokemonLevel) * 2) / 2\n\n    return pokemonLevel\n}\n\nfunction getGymLevel(gym) {\n    return 6 - gym['slots_available']\n}\n\nfunction getRaidLevel(raid) {\n    if (raid === null) {\n        return 0\n    } else {\n        return raid['level']\n    }\n}\n\nfunction lpad(str, len, padstr) {\n    return Array(Math.max(len - String(str).length + 1, 0)).join(padstr) + str\n}\n\nfunction repArray(text, find, replace) {\n    for (var i = 0; i < find.length; i++) {\n        text = text.replace(find[i], replace[i])\n    }\n\n    return text\n}\n\nfunction getTimeUntil(time) {\n    var now = Date.now()\n    var tdiff = time - now\n\n    var sec = Math.floor((tdiff / 1000) % 60)\n    var min = Math.floor((tdiff / 1000 / 60) % 60)\n    var hour = Math.floor((tdiff / (1000 * 60 * 60)) % 24)\n\n    return {\n        'total': tdiff,\n        'hour': hour,\n        'min': min,\n        'sec': sec,\n        'now': now,\n        'ttime': time\n    }\n}\n\nfunction getNotifyText(item) {\n    var iv = getIv(item['individual_attack'], item['individual_defense'], item['individual_stamina'])\n    var find = ['<prc>', '<pkm>', '<atk>', '<def>', '<sta>']\n    var replace = [((iv) ? iv.toFixed(1) : ''), item['pokemon_name'], item['individual_attack'],\n        item['individual_defense'], item['individual_stamina']]\n    var ntitle = repArray(((iv) ? notifyIvTitle : notifyNoIvTitle), find, replace)\n    var dist = moment(item['disappear_time']).format('HH:mm:ss')\n    var until = getTimeUntil(item['disappear_time'])\n    var udist = (until.hour > 0) ? until.hour + ':' : ''\n    udist += lpad(until.min, 2, 0) + 'm' + lpad(until.sec, 2, 0) + 's'\n    find = ['<dist>', '<udist>']\n    replace = [dist, udist]\n    var ntext = repArray(notifyText, find, replace)\n\n    return {\n        'fav_title': ntitle,\n        'fav_text': ntext\n    }\n}\n\nfunction playPokemonSound(pokemonID, cryFileTypes) {\n    if (!Store.get('playSound')) {\n        return\n    }\n\n    if (!Store.get('playCries')) {\n        audio.play()\n    } else {\n        // Stop if we don't have any supported filetypes left.\n        if (cryFileTypes.length === 0) {\n            return\n        }\n\n        // Try to load the first filetype in the list.\n        const filetype = cryFileTypes.shift()\n        const audioCry = new Audio('static/sounds/cries/' + pokemonID + '.' + filetype)\n\n        audioCry.play().catch(function (err) {\n            // Try a different filetype.\n            if (err) {\n                console.log('Sound filetype %s for Pokmon %s is missing.', filetype, pokemonID)\n\n                // If there's more left, try something else.\n                playPokemonSound(pokemonID, cryFileTypes)\n            }\n        })\n    }\n}\n\nfunction isNotifyPoke(poke) {\n    const isOnNotifyList = notifiedPokemon.indexOf(poke['pokemon_id']) > -1 || notifiedRarity.indexOf(poke['pokemon_rarity']) > -1\n    var hasHighIV = false\n\n    if (poke['individual_attack'] != null) {\n        const perfection = getIv(poke['individual_attack'], poke['individual_defense'], poke['individual_stamina'])\n        hasHighIV = notifiedMinPerfection > 0 && perfection >= notifiedMinPerfection\n    }\n\n    return isOnNotifyList || hasHighIV\n}\n\nfunction customizePokemonMarker(marker, item, skipNotification) {\n    var notifyText = getNotifyText(item)\n    marker.addListener('click', function () {\n        this.setAnimation(null)\n        this.animationDisabled = true\n    })\n\n    if (!marker.rangeCircle && isRangeActive(map)) {\n        marker.rangeCircle = addRangeCircle(marker, map, 'pokemon')\n    }\n\n    marker.infoWindow = new google.maps.InfoWindow({\n        content: pokemonLabel(item),\n        disableAutoPan: true\n    })\n\n    if (isNotifyPoke(item)) {\n        if (!skipNotification) {\n            playPokemonSound(item['pokemon_id'], cryFileTypes)\n            sendNotification(notifyText.fav_title, notifyText.fav_text, 'static/icons/' + item['pokemon_id'] + '.png', item['latitude'], item['longitude'])\n        }\n        if (marker.animationDisabled !== true) {\n            marker.setAnimation(google.maps.Animation.BOUNCE)\n        }\n    }\n\n    addListeners(marker)\n}\n\nfunction setupGymMarker(item) {\n    var marker = new google.maps.Marker({\n        position: {\n            lat: item['latitude'],\n            lng: item['longitude']\n        },\n        map: map\n    })\n    marker.infoWindow = new google.maps.InfoWindow({\n        content: '',\n        disableAutoPan: true\n    })\n    updateGymMarker(item, marker)\n\n    if (!marker.rangeCircle && isRangeActive(map)) {\n        marker.rangeCircle = addRangeCircle(marker, map, 'gym', item['team_id'])\n    }\n\n\n    if (Store.get('useGymSidebar')) {\n        marker.addListener('click', function () {\n            var gymSidebar = document.querySelector('#gym-details')\n            if (gymSidebar.getAttribute('data-id') === item['gym_id'] && gymSidebar.classList.contains('visible')) {\n                gymSidebar.classList.remove('visible')\n            } else {\n                gymSidebar.setAttribute('data-id', item['gym_id'])\n                showGymDetails(item['gym_id'])\n            }\n        })\n\n        google.maps.event.addListener(marker.infoWindow, 'closeclick', function () {\n            marker.persist = null\n        })\n\n        if (!isMobileDevice() && !isTouchDevice()) {\n            marker.addListener('mouseover', function () {\n                marker.infoWindow.open(map, marker)\n                clearSelection()\n                updateLabelDiffTime()\n            })\n        }\n\n        marker.addListener('mouseout', function () {\n            if (!marker.persist) {\n                marker.infoWindow.close()\n            }\n        })\n    } else {\n        addListeners(marker)\n    }\n\n    return marker\n}\n\nfunction updateGymMarker(item, marker) {\n    let raidLevel = getRaidLevel(item.raid)\n    const pokemonWithImages = [\n        3, 6, 9, 59, 65, 68, 89, 94, 103, 110, 112, 125, 126, 129, 131, 134,\n        135, 136, 143, 144, 145, 146, 153, 156, 159, 248, 249\n    ]\n    if (item.raid !== null && isOngoingRaid(item.raid) && Store.get('showRaids') && raidLevel >= Store.get('showRaidMinLevel') && raidLevel <= Store.get('showRaidMaxLevel')) {\n        let markerImage = 'static/images/raid/' + gymTypes[item.team_id] + '_' + item.raid.level + '_unknown.png'\n        if (pokemonWithImages.indexOf(item.raid.pokemon_id) !== -1) {\n            markerImage = 'static/images/raid/' + gymTypes[item.team_id] + '_' + item['raid']['pokemon_id'] + '.png'\n        }\n        marker.setIcon({\n            url: markerImage,\n            scaledSize: new google.maps.Size(48, 48)\n        })\n        marker.setZIndex(google.maps.Marker.MAX_ZINDEX + 1)\n    } else if (item.raid !== null && item.raid.end > Date.now() && Store.get('showRaids') && !Store.get('showActiveRaidsOnly') && raidLevel >= Store.get('showRaidMinLevel') && raidLevel <= Store.get('showRaidMaxLevel')) {\n        marker.setIcon({\n            url: 'static/images/gym/' + gymTypes[item.team_id] + '_' + getGymLevel(item) + '_' + item['raid']['level'] + '.png',\n            scaledSize: new google.maps.Size(48, 48)\n        })\n    } else {\n        marker.setIcon({\n            url: 'static/images/gym/' + gymTypes[item.team_id] + '_' + getGymLevel(item) + '.png',\n            scaledSize: new google.maps.Size(48, 48)\n        })\n        marker.setZIndex(1)\n    }\n    marker.infoWindow.setContent(gymLabel(item))\n    return marker\n}\n\nfunction setupPokestopMarker(item) {\n    var imagename = item['lure_expiration'] ? 'PokestopLured' : 'Pokestop'\n    var image = {\n        url: 'static/images/pokestop/' + imagename + '.png',\n        scaledSize: new google.maps.Size(32, 32)\n    }\n    var marker = new google.maps.Marker({\n        position: {\n            lat: item['latitude'],\n            lng: item['longitude']\n        },\n        map: map,\n        zIndex: item['lure_expiration'] ? 3 : 2,\n        icon: image\n    })\n\n    if (!marker.rangeCircle && isRangeActive(map)) {\n        marker.rangeCircle = addRangeCircle(marker, map, 'pokestop')\n    }\n\n    marker.infoWindow = new google.maps.InfoWindow({\n        content: pokestopLabel(item['lure_expiration'], item['latitude'], item['longitude']),\n        disableAutoPan: true\n    })\n\n    addListeners(marker)\n    return marker\n}\n\nfunction getColorByDate(value) {\n    // Changes the color from red to green over 15 mins\n    var diff = (Date.now() - value) / 1000 / 60 / 15\n\n    if (diff > 1) {\n        diff = 1\n    }\n\n    // value from 0 to 1 - Green to Red\n    var hue = ((1 - diff) * 120).toString(10)\n    return ['hsl(', hue, ',100%,50%)'].join('')\n}\n\nfunction setupScannedMarker(item) {\n    var circleCenter = new google.maps.LatLng(item['latitude'], item['longitude'])\n\n    var marker = new google.maps.Circle({\n        map: map,\n        clickable: false,\n        center: circleCenter,\n        radius: (showConfig.pokemons === true ? 70 : 450), // metres\n        fillColor: getColorByDate(item['last_modified']),\n        fillOpacity: 0.1,\n        strokeWeight: 1,\n        strokeOpacity: 0.5\n    })\n\n    return marker\n}\n\nfunction getColorBySpawnTime(value) {\n    var now = new Date()\n    var seconds = now.getMinutes() * 60 + now.getSeconds()\n\n    // account for hour roll-over\n    if (seconds < 900 && value > 2700) {\n        seconds += 3600\n    } else if (seconds > 2700 && value < 900) {\n        value += 3600\n    }\n\n    var diff = (seconds - value)\n    var hue = 275 // light purple when spawn is neither about to spawn nor active\n    if (diff >= 0 && diff <= 1800) { // green to red over 30 minutes of active spawn\n        hue = (1 - (diff / 60 / 30)) * 120\n    } else if (diff < 0 && diff > -300) { // light blue to dark blue over 5 minutes til spawn\n        hue = ((1 - (-diff / 60 / 5)) * 50) + 200\n    }\n\n    hue = Math.round(hue / 5) * 5\n\n    return hue\n}\n\nfunction changeSpawnIcon(color, zoom) {\n    var urlColor = ''\n    if (color === 275) {\n        urlColor = './static/icons/hsl-275-light.png'\n    } else {\n        urlColor = './static/icons/hsl-' + color + '.png'\n    }\n    var zoomScale = 1.6 // adjust this value to change the size of the spawnpoint icons\n    var minimumSize = 1\n    var newSize = Math.round(zoomScale * (zoom - 10)) // this scales the icon based on zoom\n    if (newSize < minimumSize) {\n        newSize = minimumSize\n    }\n\n    var newIcon = {\n        url: urlColor,\n        scaledSize: new google.maps.Size(newSize, newSize),\n        anchor: new google.maps.Point(newSize / 2, newSize / 2)\n    }\n\n    return newIcon\n}\n\nfunction spawnPointIndex(color) {\n    var newIndex = 1\n    var scale = 0\n    if (color >= 0 && color <= 120) { // high to low over 15 minutes of active spawn\n        scale = color / 120\n        newIndex = 100 + scale * 100\n    } else if (color >= 200 && color <= 250) { // low to high over 5 minutes til spawn\n        scale = (color - 200) / 50\n        newIndex = scale * 100\n    }\n\n    return newIndex\n}\n\nfunction setupSpawnpointMarker(item) {\n    var circleCenter = new google.maps.LatLng(item['latitude'], item['longitude'])\n    var hue = getColorBySpawnTime(item.appear_time)\n    var zoom = map.getZoom()\n\n    var marker = new google.maps.Marker({\n        map: map,\n        position: circleCenter,\n        icon: changeSpawnIcon(hue, zoom),\n        zIndex: spawnPointIndex(hue)\n    })\n\n    marker.infoWindow = new google.maps.InfoWindow({\n        content: spawnpointLabel(item),\n        disableAutoPan: true,\n        position: circleCenter\n    })\n\n    addListeners(marker)\n\n    return marker\n}\n\nfunction clearSelection() {\n    if (document.selection) {\n        document.selection.empty()\n    } else if (window.getSelection) {\n        window.getSelection().removeAllRanges()\n    }\n}\n\nfunction addListeners(marker) {\n    marker.addListener('click', function () {\n        if (!marker.infoWindowIsOpen) {\n            marker.infoWindow.open(map, marker)\n            clearSelection()\n            updateLabelDiffTime()\n            marker.persist = true\n            marker.infoWindowIsOpen = true\n        } else {\n            marker.persist = null\n            marker.infoWindow.close()\n            marker.infoWindowIsOpen = false\n        }\n    })\n\n    google.maps.event.addListener(marker.infoWindow, 'closeclick', function () {\n        marker.persist = null\n    })\n\n    if (!isMobileDevice() && !isTouchDevice()) {\n        marker.addListener('mouseover', function () {\n            marker.infoWindow.open(map, marker)\n            clearSelection()\n            updateLabelDiffTime()\n        })\n    }\n\n    marker.addListener('mouseout', function () {\n        if (!marker.persist) {\n            marker.infoWindow.close()\n        }\n    })\n\n    return marker\n}\n\nfunction clearStaleMarkers() {\n    const oldPokeMarkers = []\n\n    $.each(mapData.pokemons, function (key, value) {\n        const isPokeExpired = mapData.pokemons[key]['disappear_time'] < Date.now()\n        const isPokeExcluded = excludedPokemon.indexOf(mapData.pokemons[key]['pokemon_id']) !== -1\n\n        if (isPokeExpired || isPokeExcluded) {\n            const oldMarker = mapData.pokemons[key].marker\n\n            if (oldMarker.rangeCircle) {\n                oldMarker.rangeCircle.setMap(null)\n                delete oldMarker.rangeCircle\n            }\n\n            // If it was a Pokmon w/ notification it won't be in a cluster,\n            // but that doesn't matter because the MarkerClusterer will check\n            // for it itself.\n            oldPokeMarkers.push(oldMarker)\n            oldMarker.setMap(null)\n            delete mapData.pokemons[key]\n            // Overwrite method to avoid all timing issues with libraries.\n            oldMarker.setMap = function () {}\n        }\n    })\n\n    markerCluster.removeMarkers(oldPokeMarkers, true)\n\n    $.each(mapData.lurePokemons, function (key, value) {\n        if (mapData.lurePokemons[key]['lure_expiration'] < new Date().getTime() ||\n            excludedPokemon.indexOf(mapData.lurePokemons[key]['pokemon_id']) >= 0) {\n            mapData.lurePokemons[key].marker.setMap(null)\n            delete mapData.lurePokemons[key]\n        }\n    })\n\n    $.each(mapData.scanned, function (key, value) {\n        // If older than 15mins remove\n        if (mapData.scanned[key]['last_modified'] < (new Date().getTime() - 15 * 60 * 1000)) {\n            mapData.scanned[key].marker.setMap(null)\n            delete mapData.scanned[key]\n        }\n    })\n}\n\nfunction showInBoundsMarkers(markers, type) {\n    $.each(markers, function (key, value) {\n        const item = markers[key]\n        const marker = item.marker\n        var show = false\n\n        if (!item.hidden) {\n            if (typeof marker.getBounds === 'function') {\n                if (map.getBounds().intersects(marker.getBounds())) {\n                    show = true\n                }\n            } else if (typeof marker.getPosition === 'function') {\n                if (map.getBounds().contains(marker.getPosition())) {\n                    show = true\n                }\n            }\n        }\n\n        // Marker has an associated range.\n        if (show && rangeMarkers.indexOf(type) !== -1) {\n            // No range circle yet... let's create one.\n            if (!marker.rangeCircle) {\n                // But only if range is active.\n                if (isRangeActive(map)) {\n                    if (type === 'gym') marker.rangeCircle = addRangeCircle(marker, map, type, item.team_id)\n                    else marker.rangeCircle = addRangeCircle(marker, map, type)\n                }\n            } else { // There's already a range circle.\n                if (isRangeActive(map)) {\n                    marker.rangeCircle.setMap(map)\n                } else {\n                    marker.rangeCircle.setMap(null)\n                }\n            }\n        }\n\n        if (show && !marker.getMap()) {\n            marker.setMap(map)\n            // Not all markers can be animated (ex: scan locations)\n            if (marker.setAnimation && marker.oldAnimation) {\n                marker.setAnimation(marker.oldAnimation)\n            }\n        } else if (!show && marker.getMap()) {\n            // Not all markers can be animated (ex: scan locations)\n            if (marker.getAnimation) {\n                marker.oldAnimation = marker.getAnimation()\n            }\n            if (marker.rangeCircle) marker.rangeCircle.setMap(null)\n            marker.setMap(null)\n        }\n    })\n}\n\nfunction loadRawData() {\n    var loadPokemon = Store.get('showPokemon')\n    var loadGyms = (Store.get('showGyms') || Store.get('showRaids'))\n    var loadPokestops = Store.get('showPokestops')\n    var loadScanned = Store.get('showScanned')\n    var loadSpawnpoints = Store.get('showSpawnpoints')\n    var loadLuredOnly = Boolean(Store.get('showLuredPokestopsOnly'))\n\n    var bounds = map.getBounds()\n    var swPoint = bounds.getSouthWest()\n    var nePoint = bounds.getNorthEast()\n    var swLat = swPoint.lat()\n    var swLng = swPoint.lng()\n    var neLat = nePoint.lat()\n    var neLng = nePoint.lng()\n\n    return $.ajax({\n        url: 'raw_data',\n        type: 'GET',\n        data: {\n            'timestamp': timestamp,\n            'pokemon': loadPokemon,\n            'lastpokemon': lastpokemon,\n            'pokestops': loadPokestops,\n            'lastpokestops': lastpokestops,\n            'luredonly': loadLuredOnly,\n            'gyms': loadGyms,\n            'lastgyms': lastgyms,\n            'scanned': loadScanned,\n            'lastslocs': lastslocs,\n            'spawnpoints': loadSpawnpoints,\n            'lastspawns': lastspawns,\n            'swLat': swLat,\n            'swLng': swLng,\n            'neLat': neLat,\n            'neLng': neLng,\n            'oSwLat': oSwLat,\n            'oSwLng': oSwLng,\n            'oNeLat': oNeLat,\n            'oNeLng': oNeLng,\n            'reids': String(reincludedPokemon),\n            'eids': String(excludedPokemon)\n        },\n        dataType: 'json',\n        cache: false,\n        beforeSend: function () {\n            if (rawDataIsLoading) {\n                return false\n            } else {\n                rawDataIsLoading = true\n            }\n        },\n        error: function () {\n            // Display error toast\n            toastr['error']('Please check connectivity or reduce marker settings.', 'Error getting data')\n            toastr.options = {\n                'closeButton': true,\n                'debug': false,\n                'newestOnTop': true,\n                'progressBar': false,\n                'positionClass': 'toast-top-right',\n                'preventDuplicates': true,\n                'onclick': null,\n                'showDuration': '300',\n                'hideDuration': '1000',\n                'timeOut': '25000',\n                'extendedTimeOut': '1000',\n                'showEasing': 'swing',\n                'hideEasing': 'linear',\n                'showMethod': 'fadeIn',\n                'hideMethod': 'fadeOut'\n            }\n        },\n        complete: function () {\n            rawDataIsLoading = false\n        }\n    })\n}\n\nfunction processPokemons(pokemon) {\n    if (!Store.get('showPokemon')) {\n        return false // In case the checkbox was unchecked in the meantime.\n    }\n\n    // Process Pokmon per chunk of total so we don't overwhelm the client and\n    // allow redraws in between. We enable redraw in addMarkers, which doesn't\n    // repaint/reset all previous markers but only draws new ones.\n    processPokemonChunked(pokemon, Store.get('processPokemonChunkSize'))\n}\n\nfunction processPokemonChunked(pokemon, chunkSize) {\n    // Early skip if we have nothing to process.\n    if (typeof pokemon === 'undefined' || pokemon.length === 0) {\n        return\n    }\n\n    const oldMarkers = []\n    const newMarkers = []\n    const chunk = pokemon.splice(-1 * chunkSize)\n\n    $.each(chunk, function (i, poke) {\n        // Early skip if we've already stored this spawn or if it's expiring\n        // too soon.\n        const encounterId = poke.encounter_id\n        const expiringSoon = (poke.disappear_time < (Date.now() + 3000))\n        if (mapData.pokemons.hasOwnProperty(encounterId) || expiringSoon) {\n            return\n        }\n\n        const markers = processPokemon(poke)\n        const newMarker = markers[0]\n        const oldMarker = markers[1]\n\n        // Don't add Pokmon marker to clusters if we're sending a notification.\n        if (!isNotifyPoke(poke)) {\n            if (newMarker) {\n                newMarkers.push(newMarker)\n            }\n\n            if (oldMarker) {\n                oldMarkers.push(oldMarker)\n            }\n        } else {\n            if (newMarker) {\n                newMarker.setMap(map)\n            }\n\n            if (oldMarker) {\n                oldMarker.setMap(null)\n            }\n        }\n    })\n\n    // Disable instant redraw, we'll repaint ourselves after we've added the\n    // new markers.\n    markerCluster.removeMarkers(oldMarkers, true)\n    markerCluster.addMarkers(newMarkers, false)\n\n    // Any left?\n    if (pokemon.length > 0) {\n        setTimeout(function () {\n            processPokemonChunked(pokemon, chunkSize)\n        }, Store.get('processPokemonIntervalMs'))\n    }\n}\n\nfunction processPokemon(item) {\n    const isExcludedPoke = excludedPokemon.indexOf(item['pokemon_id']) !== -1\n    const isPokeAlive = item['disappear_time'] > Date.now()\n\n    var oldMarker = null\n    var newMarker = null\n\n    if (!(item['encounter_id'] in mapData.pokemons) &&\n         !isExcludedPoke && isPokeAlive) {\n        // Add marker to map and item to dict.\n        if (!item.hidden) {\n            if (item.marker) {\n                updatePokemonMarker(item.marker, map)\n            } else {\n                newMarker = setupPokemonMarker(item, map)\n                customizePokemonMarker(newMarker, item)\n                item.marker = newMarker\n            }\n\n            mapData.pokemons[item['encounter_id']] = item\n        } else {\n            oldMarker = item.marker\n        }\n    }\n\n    return [newMarker, oldMarker]\n}\n\nfunction processPokestop(i, item) {\n    if (!Store.get('showPokestops')) {\n        return false\n    }\n\n    if (Store.get('showLuredPokestopsOnly') && !item['lure_expiration']) {\n        return true\n    }\n\n    if (!mapData.pokestops[item['pokestop_id']]) { // new pokestop, add marker to map and item to dict\n        if (item.marker && item.marker.rangeCircle) {\n            item.marker.rangeCircle.setMap(null)\n        }\n        if (item.marker) {\n            item.marker.setMap(null)\n        }\n        item.marker = setupPokestopMarker(item)\n        mapData.pokestops[item['pokestop_id']] = item\n    } else { // change existing pokestop marker to unlured/lured\n        var item2 = mapData.pokestops[item['pokestop_id']]\n        if (!!item['lure_expiration'] !== !!item2['lure_expiration']) {\n            if (item2.marker && item2.marker.rangeCircle) {\n                item2.marker.rangeCircle.setMap(null)\n            }\n            item2.marker.setMap(null)\n            item.marker = setupPokestopMarker(item)\n            mapData.pokestops[item['pokestop_id']] = item\n        }\n    }\n}\n\nfunction updatePokestops() {\n    if (!Store.get('showPokestops')) {\n        return false\n    }\n\n    var removeStops = []\n    var currentTime = new Date().getTime()\n\n    // change lured pokestop marker to unlured when expired\n    $.each(mapData.pokestops, function (key, value) {\n        if (value['lure_expiration'] && value['lure_expiration'] < currentTime) {\n            value['lure_expiration'] = null\n            if (value.marker && value.marker.rangeCircle) {\n                value.marker.rangeCircle.setMap(null)\n            }\n            value.marker.setMap(null)\n            value.marker = setupPokestopMarker(value)\n        }\n    })\n\n    // remove unlured stops if show lured only is selected\n    if (Store.get('showLuredPokestopsOnly')) {\n        $.each(mapData.pokestops, function (key, value) {\n            if (!value['lure_expiration']) {\n                removeStops.push(key)\n            }\n        })\n        $.each(removeStops, function (key, value) {\n            if (mapData.pokestops[value] && mapData.pokestops[value].marker) {\n                if (mapData.pokestops[value].marker.rangeCircle) {\n                    mapData.pokestops[value].marker.rangeCircle.setMap(null)\n                }\n                mapData.pokestops[value].marker.setMap(null)\n                delete mapData.pokestops[value]\n            }\n        })\n    }\n}\n\nfunction processGym(i, item) {\n    var gymLevel = getGymLevel(item)\n    var raidLevel = getRaidLevel(item.raid)\n\n    if (!Store.get('showGyms') && !Store.get('showRaids')) {\n        return false // in case the checkbox was unchecked in the meantime.\n    }\n\n    var removeGymFromMap = function (gymid) {\n        if (mapData.gyms[gymid] && mapData.gyms[gymid].marker) {\n            if (mapData.gyms[gymid].marker.rangeCircle) {\n                mapData.gyms[gymid].marker.rangeCircle.setMap(null)\n            }\n            mapData.gyms[gymid].marker.setMap(null)\n            delete mapData.gyms[gymid]\n        }\n    }\n\n    if (Store.get('showOpenGymsOnly')) {\n        if (item.slots_available === 0) {\n            removeGymFromMap(item['gym_id'])\n            return true\n        }\n    }\n\n    if (!Store.get('showGyms')) {\n        if (Store.get('showRaids') && !isValidRaid(item.raid)) {\n            removeGymFromMap(item['gym_id'])\n            return true\n        }\n\n        if (Store.get('showActiveRaidsOnly')) {\n            if (!isOngoingRaid(item.raid)) {\n                removeGymFromMap(item['gym_id'])\n                return true\n            }\n        }\n\n        if (raidLevel > Store.get('showRaidMaxLevel') || raidLevel < Store.get('showRaidMinLevel')) {\n            removeGymFromMap(item['gym_id'])\n            return true\n        }\n    }\n\n    if (Store.get('showTeamGymsOnly') && Store.get('showTeamGymsOnly') !== item.team_id) {\n        removeGymFromMap(item['gym_id'])\n        return true\n    }\n\n    if (Store.get('showLastUpdatedGymsOnly')) {\n        var now = new Date()\n        if ((Store.get('showLastUpdatedGymsOnly') * 3600 * 1000) + item.last_scanned < now.getTime()) {\n            removeGymFromMap(item['gym_id'])\n            return true\n        }\n    }\n\n    if (gymLevel < Store.get('minGymLevel')) {\n        removeGymFromMap(item['gym_id'])\n        return true\n    }\n\n    if (gymLevel > Store.get('maxGymLevel')) {\n        removeGymFromMap(item['gym_id'])\n        return true\n    }\n\n    if (item['gym_id'] in mapData.gyms) {\n        item.marker = updateGymMarker(item, mapData.gyms[item['gym_id']].marker)\n    } else { // add marker to map and item to dict\n        item.marker = setupGymMarker(item)\n    }\n    mapData.gyms[item['gym_id']] = item\n}\n\nfunction processScanned(i, item) {\n    if (!Store.get('showScanned')) {\n        return false\n    }\n\n    var scanId = item['latitude'] + '|' + item['longitude']\n\n    if (!(scanId in mapData.scanned)) { // add marker to map and item to dict\n        if (item.marker) {\n            item.marker.setMap(null)\n        }\n        item.marker = setupScannedMarker(item)\n        mapData.scanned[scanId] = item\n    } else {\n        mapData.scanned[scanId].last_modified = item['last_modified']\n    }\n}\n\nfunction updateScanned() {\n    if (!Store.get('showScanned')) {\n        return false\n    }\n\n    $.each(mapData.scanned, function (key, value) {\n        if (map.getBounds().intersects(value.marker.getBounds())) {\n            value.marker.setOptions({\n                fillColor: getColorByDate(value['last_modified'])\n            })\n        }\n    })\n}\n\nfunction processSpawnpoint(i, item) {\n    if (!Store.get('showSpawnpoints')) {\n        return false\n    }\n\n    var id = item['id']\n\n    if (!(id in mapData.spawnpoints)) { // add marker to map and item to dict\n        if (item.marker) {\n            item.marker.setMap(null)\n        }\n        item.marker = setupSpawnpointMarker(item)\n        mapData.spawnpoints[id] = item\n    }\n}\n\nfunction updateSpawnPoints() {\n    if (!Store.get('showSpawnpoints')) {\n        return false\n    }\n\n    var zoom = map.getZoom()\n\n    $.each(mapData.spawnpoints, function (key, value) {\n        if (map.getBounds().contains(value.marker.getPosition())) {\n            var hue = getColorBySpawnTime(value['appear_time'])\n            value.marker.setIcon(changeSpawnIcon(hue, zoom))\n            value.marker.setZIndex(spawnPointIndex(hue))\n        }\n    })\n}\n\nfunction updateMap() {\n    loadRawData().done(function (result) {\n        processPokemons(result.pokemons)\n        $.each(result.pokestops, processPokestop)\n        $.each(result.gyms, processGym)\n        $.each(result.scanned, processScanned)\n        $.each(result.spawnpoints, processSpawnpoint)\n        // showInBoundsMarkers(mapData.pokemons, 'pokemon')\n        showInBoundsMarkers(mapData.lurePokemons, 'pokemon')\n        showInBoundsMarkers(mapData.gyms, 'gym')\n        showInBoundsMarkers(mapData.pokestops, 'pokestop')\n        showInBoundsMarkers(mapData.scanned, 'scanned')\n        showInBoundsMarkers(mapData.spawnpoints, 'inbound')\n        clearStaleMarkers()\n\n        // We're done processing. Redraw.\n        markerCluster.repaint()\n\n        updateScanned()\n        updateSpawnPoints()\n        updatePokestops()\n\n        if ($('#stats').hasClass('visible')) {\n            countMarkers(map)\n        }\n\n        oSwLat = result.oSwLat\n        oSwLng = result.oSwLng\n        oNeLat = result.oNeLat\n        oNeLng = result.oNeLng\n\n        lastgyms = result.lastgyms\n        lastpokestops = result.lastpokestops\n        lastpokemon = result.lastpokemon\n        lastslocs = result.lastslocs\n        lastspawns = result.lastspawns\n\n        reids = result.reids\n        if (reids instanceof Array) {\n            reincludedPokemon = reids.filter(function (e) {\n                return this.indexOf(e) < 0\n            }, reincludedPokemon)\n        }\n        timestamp = result.timestamp\n        lastUpdateTime = Date.now()\n    })\n}\n\nfunction redrawPokemon(pokemonList) {\n    $.each(pokemonList, function (key, value) {\n        var item = pokemonList[key]\n\n        if (!item.hidden) {\n            updatePokemonMarker(item, map)\n        }\n    })\n}\n\nvar updateLabelDiffTime = function () {\n    $('.label-countdown').each(function (index, element) {\n        var disappearsAt = getTimeUntil(parseInt(element.getAttribute('disappears-at')))\n\n        var hours = disappearsAt.hour\n        var minutes = disappearsAt.min\n        var seconds = disappearsAt.sec\n        var timestring = ''\n\n        if (disappearsAt.ttime < disappearsAt.now) {\n            timestring = '(expired)'\n        } else {\n            timestring = ''\n            if (hours > 0) {\n                timestring = hours + 'hour '\n            }\n\n            timestring += lpad(minutes, 2, 0) + 'min '\n            timestring += lpad(seconds, 2, 0) + 'sec '\n            timestring += ''\n        }\n\n        $(element).text(timestring)\n    })\n}\n\nfunction getPointDistance(pointA, pointB) {\n    return google.maps.geometry.spherical.computeDistanceBetween(pointA, pointB)\n}\n\nfunction sendNotification(title, text, icon, lat, lng) {\n    if (!('Notification' in window)) {\n        return false // Notifications are not present in browser\n    }\n\n    if (Notification.permission !== 'granted') {\n        Notification.requestPermission()\n    } else {\n        var notification = new Notification(title, {\n            icon: icon,\n            body: text,\n            sound: 'sounds/ding.mp3'\n        })\n\n        notification.onclick = function () {\n            window.focus()\n            notification.close()\n\n            centerMap(lat, lng, 20)\n        }\n    }\n}\n\nfunction createMyLocationButton() {\n    var locationContainer = document.createElement('div')\n\n    var locationButton = document.createElement('button')\n    locationButton.style.backgroundColor = '#fff'\n    locationButton.style.border = 'none'\n    locationButton.style.outline = 'none'\n    locationButton.style.width = '28px'\n    locationButton.style.height = '28px'\n    locationButton.style.borderRadius = '2px'\n    locationButton.style.boxShadow = '0 1px 4px rgba(0,0,0,0.3)'\n    locationButton.style.cursor = 'pointer'\n    locationButton.style.marginRight = '10px'\n    locationButton.style.padding = '0px'\n    locationButton.title = 'My Location'\n    locationContainer.appendChild(locationButton)\n\n    var locationIcon = document.createElement('div')\n    locationIcon.style.margin = '5px'\n    locationIcon.style.width = '18px'\n    locationIcon.style.height = '18px'\n    locationIcon.style.backgroundImage = 'url(static/mylocation-sprite-1x.png)'\n    locationIcon.style.backgroundSize = '180px 18px'\n    locationIcon.style.backgroundPosition = '0px 0px'\n    locationIcon.style.backgroundRepeat = 'no-repeat'\n    locationIcon.id = 'current-location'\n    locationButton.appendChild(locationIcon)\n\n    locationButton.addEventListener('click', function () {\n        centerMapOnLocation()\n    })\n\n    locationContainer.index = 1\n    map.controls[google.maps.ControlPosition.RIGHT_BOTTOM].push(locationContainer)\n\n    google.maps.event.addListener(map, 'dragend', function () {\n        var currentLocation = document.getElementById('current-location')\n        currentLocation.style.backgroundPosition = '0px 0px'\n    })\n}\n\nfunction centerMapOnLocation() {\n    var currentLocation = document.getElementById('current-location')\n    var imgX = '0'\n    var animationInterval = setInterval(function () {\n        if (imgX === '-18') {\n            imgX = '0'\n        } else {\n            imgX = '-18'\n        }\n        currentLocation.style.backgroundPosition = imgX + 'px 0'\n    }, 500)\n    if (navigator.geolocation) {\n        navigator.geolocation.getCurrentPosition(function (position) {\n            var latlng = new google.maps.LatLng(position.coords.latitude, position.coords.longitude)\n            locationMarker.setPosition(latlng)\n            map.setCenter(latlng)\n            Store.set('followMyLocationPosition', {\n                lat: position.coords.latitude,\n                lng: position.coords.longitude\n            })\n            clearInterval(animationInterval)\n            currentLocation.style.backgroundPosition = '-144px 0px'\n        })\n    } else {\n        clearInterval(animationInterval)\n        currentLocation.style.backgroundPosition = '0px 0px'\n    }\n}\n\nfunction changeLocation(lat, lng) {\n    var loc = new google.maps.LatLng(lat, lng)\n    changeSearchLocation(lat, lng).done(function () {\n        map.setCenter(loc)\n        searchMarker.setPosition(loc)\n    })\n}\n\nfunction changeSearchLocation(lat, lng) {\n    return $.post('next_loc?lat=' + lat + '&lon=' + lng, {})\n}\n\nfunction centerMap(lat, lng, zoom) {\n    var loc = new google.maps.LatLng(lat, lng)\n\n    map.setCenter(loc)\n\n    if (zoom) {\n        storeZoom = false\n        map.setZoom(zoom)\n    }\n}\n\nfunction i8ln(word) {\n    if ($.isEmptyObject(i8lnDictionary) && language !== 'en' && languageLookups < languageLookupThreshold) {\n        $.ajax({\n            url: 'static/dist/locales/' + language + '.min.json',\n            dataType: 'json',\n            async: false,\n            success: function (data) {\n                i8lnDictionary = data\n            },\n            error: function (jqXHR, status, error) {\n                console.log('Error loading i8ln dictionary: ' + error)\n                languageLookups++\n            }\n        })\n    }\n    if (word in i8lnDictionary) {\n        return i8lnDictionary[word]\n    } else {\n        // Word doesn't exist in dictionary return it as is\n        return word\n    }\n}\n\nfunction updateGeoLocation() {\n    if (navigator.geolocation && (Store.get('geoLocate') || Store.get('followMyLocation'))) {\n        navigator.geolocation.getCurrentPosition(function (position) {\n            var lat = position.coords.latitude\n            var lng = position.coords.longitude\n            var center = new google.maps.LatLng(lat, lng)\n\n            if (Store.get('geoLocate')) {\n                // the search function makes any small movements cause a loop. Need to increase resolution\n                if ((typeof searchMarker !== 'undefined') && (getPointDistance(searchMarker.getPosition(), center) > 40)) {\n                    $.post('next_loc?lat=' + lat + '&lon=' + lng).done(function () {\n                        map.panTo(center)\n                        searchMarker.setPosition(center)\n                    })\n                }\n            }\n            if (Store.get('followMyLocation')) {\n                if ((typeof locationMarker !== 'undefined') && (getPointDistance(locationMarker.getPosition(), center) >= 5)) {\n                    map.panTo(center)\n                    locationMarker.setPosition(center)\n                    Store.set('followMyLocationPosition', {\n                        lat: lat,\n                        lng: lng\n                    })\n                }\n            }\n        })\n    }\n}\n\nfunction createUpdateWorker() {\n    try {\n        if (isMobileDevice() && (window.Worker)) {\n            var updateBlob = new Blob([`onmessage = function(e) {\n                var data = e.data\n                if (data.name === 'backgroundUpdate') {\n                    self.setInterval(function () {self.postMessage({name: 'backgroundUpdate'})}, 5000)\n                }\n            }`])\n\n            var updateBlobURL = window.URL.createObjectURL(updateBlob)\n\n            updateWorker = new Worker(updateBlobURL)\n\n            updateWorker.onmessage = function (e) {\n                var data = e.data\n                if (document.hidden && data.name === 'backgroundUpdate' && Date.now() - lastUpdateTime > 2500) {\n                    updateMap()\n                    updateGeoLocation()\n                }\n            }\n\n            updateWorker.postMessage({\n                name: 'backgroundUpdate'\n            })\n        }\n    } catch (ex) {\n        console.log('Webworker error: ' + ex.message)\n    }\n}\n\nfunction showGymDetails(id) { // eslint-disable-line no-unused-vars\n    var sidebar = document.querySelector('#gym-details')\n    var sidebarClose\n\n    sidebar.classList.add('visible')\n\n    var data = $.ajax({\n        url: 'gym_data',\n        type: 'GET',\n        data: {\n            'id': id\n        },\n        dataType: 'json',\n        cache: false\n    })\n\n    data.done(function (result) {\n        var pokemonHtml = ''\n        if (result.pokemon.length) {\n            result.pokemon.forEach((pokemon) => {\n                pokemonHtml += getSidebarGymMember(pokemon)\n            })\n\n            pokemonHtml = `<table><tbody>${pokemonHtml}</tbody></table>`\n        } else if (result.team_id === 0) {\n            pokemonHtml = ''\n        } else {\n            pokemonHtml = `\n                <center>\n                    Gym Leader:<br>\n                    <i class=\"pokemon-large-sprite n${result.guard_pokemon_id}\"></i><br>\n                    <b>${result.guard_pokemon_name}</b>\n\n                    <p style=\"font-size: .75em; margin: 5px;\">\n                        No additional gym information is available for this gym. Make sure you are collecting <a href=\"https://rocketmap.readthedocs.io/en/develop/extras/gyminfo.html\">detailed gym info.</a>\n                        If you have detailed gym info collection running, this gym's Pokemon information may be out of date.\n                    </p>\n                </center>\n            `\n        }\n\n        var topPart = gymLabel(result, false)\n        sidebar.innerHTML = `${topPart}${pokemonHtml}`\n\n        sidebarClose = document.createElement('a')\n        sidebarClose.href = '#'\n        sidebarClose.className = 'close'\n        sidebarClose.tabIndex = 0\n        sidebar.appendChild(sidebarClose)\n\n        sidebarClose.addEventListener('click', function (event) {\n            event.preventDefault()\n            event.stopPropagation()\n            sidebar.classList.remove('visible')\n        })\n    })\n}\n\nfunction getSidebarGymMember(pokemon) {\n    var perfectPercent = getIv(pokemon.iv_attack, pokemon.iv_defense, pokemon.iv_stamina)\n    var moveEnergy = Math.round(100 / pokemon.move_2_energy)\n\n\n    return `\n                    <tr onclick=toggleGymPokemonDetails(this)>\n                        <td width=\"30px\">\n                            <img class=\"gym pokemon sprite\" src=\"static/icons/${pokemon.pokemon_id}.png\">\n                        </td>\n                        <td>\n                            <div class=\"gym pokemon\" style=\"line-height:0.5em;\">${pokemon.pokemon_name}</div>\n                            <div><img class=\"gym pokemon motivation heart\" src=\"static/images/gym/Heart.png\"> <span class=\"gym pokemon motivation\">${pokemon.cp_decayed}</span></div>\n                        </td>\n                        <td width=\"190\" align=\"center\">\n                            <div class=\"gym pokemon\" style=\"line-height:1em;\">${pokemon.trainer_name} (${pokemon.trainer_level})</div>\n                            <div class=\"gym pokemon\">Deployed ${getDateStr(pokemon.deployment_time)}</div>\n                        </td>\n                        <td width=\"10\">\n                            <!--<a href=\"#\" onclick=\"toggleGymPokemonDetails(this)\">-->\n                                <i class=\"fa fa-angle-double-down\"></i>\n                            <!--</a>-->\n                        </td>\n                    </tr>\n                    <tr class=\"details\">\n                        <td colspan=\"2\">\n                            <div class=\"ivs\">\n                                <div class=\"iv\">\n                                    <div class=\"type\">ATK</div>\n                                    <div class=\"value\">\n                                        ${pokemon.iv_attack}\n                                    </div>\n                                </div>\n                                <div class=\"iv\">\n                                    <div class=\"type\">DEF</div>\n                                    <div class=\"value\">\n                                        ${pokemon.iv_defense}\n                                    </div>\n                                </div>\n                                <div class=\"iv\">\n                                    <div class=\"type\">STA</div>\n                                    <div class=\"value\">\n                                        ${pokemon.iv_stamina}\n                                    </div>\n                                </div>\n                                <div class=\"iv\" style=\"width: 36px;\"\">\n                                    <div class=\"type\">PERFECT</div>\n                                    <div class=\"value\">\n                                        ${perfectPercent.toFixed(0)}<span style=\"font-size: .6em;\">%</span>\n                                    </div>\n                                </div>\n                            </div>\n                        </td>\n                        <td colspan=\"2\">\n                            <div class=\"moves\">\n                                <div class=\"move\">\n                                    <div class=\"name\">\n                                        ${pokemon.move_1_name}\n                                        <div class=\"type ${pokemon.move_1_type['type_en'].toLowerCase()}\">${pokemon.move_1_type['type']}</div>\n                                    </div>\n                                    <div class=\"damage\">\n                                        ${pokemon.move_1_damage}\n                                    </div>\n                                </div>\n                                <br>\n                                <div class=\"move\">\n                                    <div class=\"name\">\n                                        ${pokemon.move_2_name}\n                                        <div class=\"type ${pokemon.move_2_type['type_en'].toLowerCase()}\">${pokemon.move_2_type['type']}</div>\n                                        <div>\n                                            <i class=\"move-bar-sprite move-bar-sprite-${moveEnergy}\"></i>\n                                        </div>\n                                    </div>\n                                    <div class=\"damage\">\n                                        ${pokemon.move_2_damage}\n                                    </div>\n                                </div>\n                            </div>\n                        </td>\n                    </tr>\n                    `\n}\n\nfunction toggleGymPokemonDetails(e) { // eslint-disable-line no-unused-vars\n    e.lastElementChild.firstElementChild.classList.toggle('fa-angle-double-up')\n    e.lastElementChild.firstElementChild.classList.toggle('fa-angle-double-down')\n    e.nextElementSibling.classList.toggle('visible')\n}\n\nfunction getParameterByName(name, url) {\n    if (!url) {\n        url = window.location.search\n    }\n    name = name.replace(/[[\\]]/g, '\\\\$&')\n    var regex = new RegExp('[?&]' + name + '(=([^&#]*)|&|#|$)')\n    var results = regex.exec(url)\n    if (!results) {\n        return null\n    }\n    if (!results[2]) {\n        return ''\n    }\n    return decodeURIComponent(results[2].replace(/\\+/g, ' '))\n}\n\n\n//\n// Page Ready Execution\n//\n\n$(function () {\n    if (!Notification) {\n        console.log('could not load notifications')\n        return\n    }\n\n    if (Notification.permission !== 'granted') {\n        Notification.requestPermission()\n    }\n})\n\n$(function () {\n    // populate Navbar Style menu\n    $selectStyle = $('#map-style')\n\n    // Load Stylenames, translate entries, and populate lists\n    $.getJSON('static/dist/data/mapstyle.min.json').done(function (data) {\n        var styleList = []\n\n        $.each(data, function (key, value) {\n            styleList.push({\n                id: key,\n                text: i8ln(value)\n            })\n        })\n\n        // setup the stylelist\n        $selectStyle.select2({\n            placeholder: 'Select Style',\n            data: styleList,\n            minimumResultsForSearch: Infinity\n        })\n\n        // setup the list change behavior\n        $selectStyle.on('change', function (e) {\n            selectedStyle = $selectStyle.val()\n            map.setMapTypeId(selectedStyle)\n            Store.set('map_style', selectedStyle)\n        })\n\n        // recall saved mapstyle\n        $selectStyle.val(Store.get('map_style')).trigger('change')\n    })\n\n    $selectIconSize = $('#pokemon-icon-size')\n\n    $selectIconSize.select2({\n        placeholder: 'Select Icon Size',\n        minimumResultsForSearch: Infinity\n    })\n\n    $selectIconSize.on('change', function () {\n        Store.set('iconSizeModifier', this.value)\n        redrawPokemon(mapData.pokemons)\n        redrawPokemon(mapData.lurePokemons)\n\n        // We're done processing the list. Redraw.\n        markerCluster.resetViewport()\n        markerCluster.redraw()\n    })\n\n    $switchOpenGymsOnly = $('#open-gyms-only-switch')\n\n    $switchOpenGymsOnly.on('change', function () {\n        Store.set('showOpenGymsOnly', this.checked)\n        lastgyms = false\n        updateMap()\n    })\n\n    $switchActiveRaidGymsOnly = $('#raid-active-gym-switch')\n\n    $switchActiveRaidGymsOnly.on('change', function () {\n        Store.set('showActiveRaidsOnly', this.checked)\n        lastgyms = false\n        updateMap()\n    })\n\n    $switchRaidMinLevel = $('#raid-min-level-only-switch')\n\n    $switchRaidMinLevel.select2({\n        placeholder: 'Minimum raid level',\n        minimumResultsForSearch: Infinity\n    })\n\n    $switchRaidMinLevel.on('change', function () {\n        Store.set('showRaidMinLevel', this.value)\n        lastgyms = false\n        updateMap()\n    })\n\n    $switchRaidMaxLevel = $('#raid-max-level-only-switch')\n\n    $switchRaidMaxLevel.select2({\n        placeholder: 'Maximum raid level',\n        minimumResultsForSearch: Infinity\n    })\n\n    $switchRaidMaxLevel.on('change', function () {\n        Store.set('showRaidMaxLevel', this.value)\n        lastgyms = false\n        updateMap()\n    })\n\n\n    $selectTeamGymsOnly = $('#team-gyms-only-switch')\n\n    $selectTeamGymsOnly.select2({\n        placeholder: 'Only Show Gyms For Team',\n        minimumResultsForSearch: Infinity\n    })\n\n    $selectTeamGymsOnly.on('change', function () {\n        Store.set('showTeamGymsOnly', this.value)\n        lastgyms = false\n        updateMap()\n    })\n\n    $selectLastUpdateGymsOnly = $('#last-update-gyms-switch')\n\n    $selectLastUpdateGymsOnly.select2({\n        placeholder: 'Only Show Gyms Last Updated',\n        minimumResultsForSearch: Infinity\n    })\n\n    $selectLastUpdateGymsOnly.on('change', function () {\n        Store.set('showLastUpdatedGymsOnly', this.value)\n        lastgyms = false\n        updateMap()\n    })\n\n    $selectMinGymLevel = $('#min-level-gyms-filter-switch')\n\n    $selectMinGymLevel.select2({\n        placeholder: 'Minimum Gym Level',\n        minimumResultsForSearch: Infinity\n    })\n\n    $selectMinGymLevel.on('change', function () {\n        Store.set('minGymLevel', this.value)\n        lastgyms = false\n        updateMap()\n    })\n\n    $selectMaxGymLevel = $('#max-level-gyms-filter-switch')\n\n    $selectMaxGymLevel.select2({\n        placeholder: 'Maximum Gym Level',\n        minimumResultsForSearch: Infinity\n    })\n\n    $selectMaxGymLevel.on('change', function () {\n        Store.set('maxGymLevel', this.value)\n        lastgyms = false\n        updateMap()\n    })\n\n    $selectLuredPokestopsOnly = $('#lured-pokestops-only-switch')\n\n    $selectLuredPokestopsOnly.select2({\n        placeholder: 'Only Show Lured Pokestops',\n        minimumResultsForSearch: Infinity\n    })\n\n    $selectLuredPokestopsOnly.on('change', function () {\n        Store.set('showLuredPokestopsOnly', this.value)\n        lastpokestops = false\n        updateMap()\n    })\n    $switchGymSidebar = $('#gym-sidebar-switch')\n\n    $switchGymSidebar.on('change', function () {\n        Store.set('useGymSidebar', this.checked)\n        lastgyms = false\n        $.each(['gyms'], function (d, dType) {\n            $.each(mapData[dType], function (key, value) {\n                // for any marker you're turning off, you'll want to wipe off the range\n                if (mapData[dType][key].marker.rangeCircle) {\n                    mapData[dType][key].marker.rangeCircle.setMap(null)\n                    delete mapData[dType][key].marker.rangeCircle\n                }\n                mapData[dType][key].marker.setMap(null)\n            })\n            mapData[dType] = {}\n        })\n        updateMap()\n    })\n\n    $selectSearchIconMarker = $('#iconmarker-style')\n    $selectLocationIconMarker = $('#locationmarker-style')\n\n    $.getJSON('static/dist/data/searchmarkerstyle.min.json').done(function (data) {\n        searchMarkerStyles = data\n        var searchMarkerStyleList = []\n\n        $.each(data, function (key, value) {\n            searchMarkerStyleList.push({\n                id: key,\n                text: value.name\n            })\n        })\n\n        $selectSearchIconMarker.select2({\n            placeholder: 'Select Icon Marker',\n            data: searchMarkerStyleList,\n            minimumResultsForSearch: Infinity\n        })\n\n        $selectSearchIconMarker.on('change', function (e) {\n            var selectSearchIconMarker = $selectSearchIconMarker.val()\n            Store.set('searchMarkerStyle', selectSearchIconMarker)\n            updateSearchMarker(selectSearchIconMarker)\n        })\n\n        $selectSearchIconMarker.val(Store.get('searchMarkerStyle')).trigger('change')\n\n        updateSearchMarker(Store.get('lockMarker'))\n\n        $selectLocationIconMarker.select2({\n            placeholder: 'Select Location Marker',\n            data: searchMarkerStyleList,\n            minimumResultsForSearch: Infinity\n        })\n\n        $selectLocationIconMarker.on('change', function (e) {\n            Store.set('locationMarkerStyle', this.value)\n            updateLocationMarker(this.value)\n        })\n\n        $selectLocationIconMarker.val(Store.get('locationMarkerStyle')).trigger('change')\n    })\n})\n\n$(function () {\n    moment.locale(language)\n    function formatState(state) {\n        if (!state.id) {\n            return state.text\n        }\n        var $state = $(\n            '<span><i class=\"pokemon-sprite n' + state.element.value.toString() + '\"></i> ' + state.text + '</span>'\n        )\n        return $state\n    }\n\n    if (Store.get('startAtUserLocation')) {\n        centerMapOnLocation()\n    }\n\n    $.getJSON('static/dist/data/moves.min.json').done(function (data) {\n        moves = data\n    })\n\n    $selectExclude = $('#exclude-pokemon')\n    $selectPokemonNotify = $('#notify-pokemon')\n    $selectRarityNotify = $('#notify-rarity')\n    $textPerfectionNotify = $('#notify-perfection')\n    var numberOfPokemon = 493\n\n    // Load pokemon names and populate lists\n    $.getJSON('static/dist/data/pokemon.min.json').done(function (data) {\n        var pokeList = []\n\n        $.each(data, function (key, value) {\n            if (key > numberOfPokemon) {\n                return false\n            }\n            var _types = []\n            pokeList.push({\n                id: key,\n                text: i8ln(value['name']) + ' - #' + key\n            })\n            value['name'] = i8ln(value['name'])\n            value['rarity'] = i8ln(value['rarity'])\n            $.each(value['types'], function (key, pokemonType) {\n                _types.push({\n                    'type': i8ln(pokemonType['type']),\n                    'color': pokemonType['color']\n                })\n            })\n            value['types'] = _types\n            idToPokemon[key] = value\n        })\n\n        // setup the filter lists\n        $selectExclude.select2({\n            placeholder: i8ln('Select Pokmon'),\n            data: pokeList,\n            templateResult: formatState\n        })\n        $selectPokemonNotify.select2({\n            placeholder: i8ln('Select Pokmon'),\n            data: pokeList,\n            templateResult: formatState\n        })\n        $selectRarityNotify.select2({\n            placeholder: i8ln('Select Rarity'),\n            data: [i8ln('Common'), i8ln('Uncommon'), i8ln('Rare'), i8ln('Very Rare'), i8ln('Ultra Rare')],\n            templateResult: formatState\n        })\n\n        // setup list change behavior now that we have the list to work from\n        $selectExclude.on('change', function (e) {\n            buffer = excludedPokemon\n            excludedPokemon = $selectExclude.val().map(Number)\n            buffer = buffer.filter(function (e) {\n                return this.indexOf(e) < 0\n            }, excludedPokemon)\n            reincludedPokemon = reincludedPokemon.concat(buffer)\n            clearStaleMarkers()\n            Store.set('remember_select_exclude', excludedPokemon)\n        })\n        $selectPokemonNotify.on('change', function (e) {\n            notifiedPokemon = $selectPokemonNotify.val().map(Number)\n            Store.set('remember_select_notify', notifiedPokemon)\n        })\n        $selectRarityNotify.on('change', function (e) {\n            notifiedRarity = $selectRarityNotify.val().map(String)\n            Store.set('remember_select_rarity_notify', notifiedRarity)\n        })\n        $textPerfectionNotify.on('change', function (e) {\n            notifiedMinPerfection = parseInt($textPerfectionNotify.val(), 10)\n            if (isNaN(notifiedMinPerfection) || notifiedMinPerfection <= 0) {\n                notifiedMinPerfection = ''\n            }\n            if (notifiedMinPerfection > 100) {\n                notifiedMinPerfection = 100\n            }\n            $textPerfectionNotify.val(notifiedMinPerfection)\n            Store.set('remember_text_perfection_notify', notifiedMinPerfection)\n        })\n\n        // recall saved lists\n        $selectExclude.val(Store.get('remember_select_exclude')).trigger('change')\n        $selectPokemonNotify.val(Store.get('remember_select_notify')).trigger('change')\n        $selectRarityNotify.val(Store.get('remember_select_rarity_notify')).trigger('change')\n        $textPerfectionNotify.val(Store.get('remember_text_perfection_notify')).trigger('change')\n\n        if (isTouchDevice() && isMobileDevice()) {\n            $('.select2-search input').prop('readonly', true)\n        }\n    })\n\n    // run interval timers to regularly update map and timediffs\n    window.setInterval(updateLabelDiffTime, 1000)\n    window.setInterval(updateMap, 5000)\n    window.setInterval(updateGeoLocation, 1000)\n\n    createUpdateWorker()\n\n    // Wipe off/restore map icons when switches are toggled\n    function buildSwitchChangeListener(data, dataType, storageKey) {\n        return function () {\n            Store.set(storageKey, this.checked)\n\n            if (this.checked) {\n                // When switch is turned on we asume it has been off, makes sure we dont end up in limbo\n                // Without this there could've been a situation where no markers are on map and only newly modified ones are loaded\n                if (storageKey === 'showPokemon') {\n                    lastpokemon = false\n                } else if (storageKey === 'showPokestops') {\n                    lastpokestops = false\n                } else if (storageKey === 'showScanned') {\n                    lastslocs = false\n                } else if (storageKey === 'showSpawnpoints') {\n                    lastspawns = false\n                }\n                updateMap()\n            } else if (storageKey === 'showGyms' || storageKey === 'showRaids') {\n                // if any of switch is enable then do not remove gyms markers, only update them\n                if (Store.get('showGyms') || Store.get('showRaids')) {\n                    lastgyms = false\n                    updateMap()\n                } else {\n                    $.each(dataType, function (d, dType) {\n                        $.each(data[dType], function (key, value) {\n                            // for any marker you're turning off, you'll want to wipe off the range\n                            if (data[dType][key].marker.rangeCircle) {\n                                data[dType][key].marker.rangeCircle.setMap(null)\n                                delete data[dType][key].marker.rangeCircle\n                            }\n                            data[dType][key].marker.setMap(null)\n                        })\n                        data[dType] = {}\n                    })\n                }\n            } else {\n                $.each(dataType, function (d, dType) {\n                    var oldPokeMarkers = []\n                    $.each(data[dType], function (key, value) {\n                        // for any marker you're turning off, you'll want to wipe off the range\n                        if (data[dType][key].marker.rangeCircle) {\n                            data[dType][key].marker.rangeCircle.setMap(null)\n                            delete data[dType][key].marker.rangeCircle\n                        }\n                        if (storageKey !== 'showRanges') {\n                            data[dType][key].marker.setMap(null)\n                            if (dType === 'pokemons') {\n                                oldPokeMarkers.push(data[dType][key].marker)\n                            }\n                        }\n                    })\n                    if (dType === 'pokemons') {\n                        markerCluster.removeMarkers(oldPokeMarkers)\n                    }\n                    if (storageKey !== 'showRanges') data[dType] = {}\n                })\n                if (storageKey === 'showRanges') {\n                    updateMap()\n                }\n            }\n        }\n    }\n    // Setup UI element interactions\n    $('#gyms-switch').change(function () {\n        var options = {\n            'duration': 500\n        }\n        var wrapper = $('#gym-sidebar-wrapper')\n        if (this.checked) {\n            lastgyms = false\n            wrapper.show(options)\n        } else {\n            lastgyms = false\n            wrapper.hide(options)\n        }\n        var wrapper2 = $('#gyms-filter-wrapper')\n        if (this.checked) {\n            lastgyms = false\n            wrapper2.show(options)\n        } else {\n            lastgyms = false\n            wrapper2.hide(options)\n        }\n        buildSwitchChangeListener(mapData, ['gyms'], 'showGyms').bind(this)()\n    })\n    $('#raids-switch').change(function () {\n        var options = {\n            'duration': 500\n        }\n        var wrapper = $('#raids-filter-wrapper')\n        if (this.checked) {\n            lastgyms = false\n            wrapper.show(options)\n        } else {\n            lastgyms = false\n            wrapper.hide(options)\n        }\n        buildSwitchChangeListener(mapData, ['gyms'], 'showRaids').bind(this)()\n    })\n    $('#pokemon-switch').change(function () {\n        buildSwitchChangeListener(mapData, ['pokemons'], 'showPokemon').bind(this)()\n    })\n    $('#scanned-switch').change(function () {\n        buildSwitchChangeListener(mapData, ['scanned'], 'showScanned').bind(this)()\n    })\n    $('#spawnpoints-switch').change(function () {\n        buildSwitchChangeListener(mapData, ['spawnpoints'], 'showSpawnpoints').bind(this)()\n    })\n    $('#ranges-switch').change(buildSwitchChangeListener(mapData, ['gyms', 'pokemons', 'pokestops'], 'showRanges'))\n\n    $('#pokestops-switch').change(function () {\n        var options = {\n            'duration': 500\n        }\n        var wrapper = $('#lured-pokestops-only-wrapper')\n        if (this.checked) {\n            lastpokestops = false\n            wrapper.show(options)\n        } else {\n            lastpokestops = false\n            wrapper.hide(options)\n        }\n        return buildSwitchChangeListener(mapData, ['pokestops'], 'showPokestops').bind(this)()\n    })\n\n    $('#sound-switch').change(function () {\n        Store.set('playSound', this.checked)\n        var options = {\n            'duration': 500\n        }\n        var criesWrapper = $('#pokemoncries')\n        if (this.checked) {\n            criesWrapper.show(options)\n        } else {\n            criesWrapper.hide(options)\n        }\n    })\n\n    $('#cries-switch').change(function () {\n        Store.set('playCries', this.checked)\n    })\n\n    $('#geoloc-switch').change(function () {\n        $('#next-location').prop('disabled', this.checked)\n        $('#next-location').css('background-color', this.checked ? '#e0e0e0' : '#ffffff')\n        if (!navigator.geolocation) {\n            this.checked = false\n        } else {\n            Store.set('geoLocate', this.checked)\n        }\n    })\n\n    $('#lock-marker-switch').change(function () {\n        Store.set('lockMarker', this.checked)\n        searchMarker.setDraggable(!this.checked)\n    })\n\n    $('#search-switch').change(function () {\n        searchControl(this.checked ? 'on' : 'off')\n    })\n\n    $('#start-at-user-location-switch').change(function () {\n        Store.set('startAtUserLocation', this.checked)\n    })\n\n    $('#follow-my-location-switch').change(function () {\n        if (!navigator.geolocation) {\n            this.checked = false\n        } else {\n            Store.set('followMyLocation', this.checked)\n        }\n        locationMarker.setDraggable(!this.checked)\n    })\n\n    $('#scan-here-switch').change(function () {\n        if (this.checked && !Store.get('scanHereAlerted')) {\n            alert('Use this feature carefully ! This button will set the current map center as new search location. This may cause worker to teleport long range.')\n            Store.set('scanHereAlerted', true)\n        }\n        $('#scan-here').toggle(this.checked)\n        Store.set('scanHere', this.checked)\n    })\n\n    if ($('#nav-accordion').length) {\n        $('#nav-accordion').accordion({\n            active: 0,\n            collapsible: true,\n            heightStyle: 'content'\n        })\n    }\n\n    // Initialize dataTable in statistics sidebar\n    //   - turn off sorting for the 'icon' column\n    //   - initially sort 'name' column alphabetically\n\n    $('#pokemonList_table').DataTable({\n        paging: false,\n        searching: false,\n        info: false,\n        errMode: 'throw',\n        'language': {\n            'emptyTable': ''\n        },\n        'columns': [\n            { 'orderable': false },\n            null,\n            null,\n            null\n        ]\n    }).order([1, 'asc'])\n})\n"]}